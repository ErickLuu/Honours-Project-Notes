\section{Monochromatic paths}

We wish to find a book-embedding of an almost-embeddable graph on some orientable surface. To do so, we need to introduce some new terminology to work with vortices on surfaces. 
Recall the definition of $(g, p, k, a)$-almost-embeddable from \cref{ssec:Robertson_Seymour_Graph_Structure}. A graph $G$ is $(g, p, k)$-almost-embeddable if $G$ is $(g, p, k, 0)$-almost-embeddable, so $G$ has no apex set.
What we attempted to show was this:
\begin{theorem}\label{thm:bounded_almost_embeddable}
	Suppose $G$ is $(g, p, k)$-almost embeddable on an orientable surface. Then $G$ can be embedded on \(f(g, p, k)\) pages for some function $f$.
\end{theorem}

The most problematic section is dealing with vortices on surfaces.
To work with vortices, consider how an ordering affects the face that the vortex is sitting on. Then see what happens when the vortex is added onto the face. 

Let \(F\) be a face on \(G\). Let \( (<, \varphi) \) be a book-embedding of \(G\). A \textit{monochromatic path} $P$ on the boundary of $F$ is a maximal path where every edge is given the same colour from $\varphi$. Then $F$ being a preserved face implies that $F$ has a single monochromatic path, but not the other way around. We were not able to show that every planar graph has a book-embedding where every face has a bounded number of monochromatic paths. This would imply that every graph embedded on an orientable surface can be embedded on a bounded number of pages. 

\begin{figure}[h!]
	\centering
	\includesvg[width = 0.8\textwidth]{figures/monochromatic_paths.svg}
	\caption[Monochromatic paths]{An example of a monochromatic path on a face. Above is a face embedded on $\mathbb{R}^2$. The circular book-embedding has edges coloured red and blue. This face has four monochromatic paths. Below is a circular ordering of the vertices on the boundary of the face. Every edge coloured red is embedded on a single page.}
\end{figure}

Preserved faces allow us to embed vortices with a bounded number of pages. 

\begin{lemma}[Vortex on preserved faces]\label{lem:preserved_faces_pagenumber}
	Suppose a graph \(G = G_0 \cup G_1\), where \(G_0\) is embedded on a surface $\Sigma$ and \(G_1\) is a vortex on a face $F$ of $G_0$ with depth \(k\). Suppose $(<, \varphi)$ is a $p$-page book-embedding of \(G_0\) which preserves \(F\). Then $G$ can be embedded on \(p + k + 1\) pages. Furthermore, the new ordering restricted to $G_0$ is $(<, \varphi)$.
\end{lemma}

\begin{proof}
	We repeat a similar argument to \cref{thm:bded_treewidth_bded_pagenumber}. Let \(B_1, \ldots, B_i\) be a path-decomposition of \(G_1\). Let \(\sigma(v)\) be the first time \(v\) appears in the path-decomposition. Colour the edges of \(G_1\) as such. If \(uv \in E(G_1)\), then:
	\begin{equation}
		c(uv) =
		\begin{cases}
			c(T_u) & \text{ if } \sigma(u) \leq \sigma(v), \\
			c(T_v) & \text{ if } \sigma(v) \leq \sigma(u).
		\end{cases}
	\end{equation}
	This is a book-embedding of \(G_1\) with \(k+1\) colours. Since the intersection graphs of every graph is perfect, we can colour with $k + 1$ colours. Furthermore, suppose that edges \(uv\), \(xy\) cross, so \(\sigma(u) \leq \sigma(x) \leq \sigma(v) \leq \sigma(y)\). However, this implies that $u,x,v$ are in some bag $B$. So \(uv\) is an edge in \(B\), and we do a depth-first search to establish the ordering of $\sigma(u)$. So \(u, x, v\) are in the same bags. However, this implies that the trees \(T_u\) and \(T_x\) intersect, meaning that \(c(uv) \neq c(xy)\). Therefore, all crossing edges are assigned different colours. 

	To add this book-embedding to \(G_0\), add the vertices that appear first in \(B_i\) after the associated vertex \(v_i\) in \(G_0\) such that \(v_i\) is on the face \(F\) and \(v_i \in B_i\). This is a book-embedding of \(G\) requiring at most \(\pn(G_0) + k + 1\) colours. An illustration of such a book-embedding is in \cref{fig:preserved_face}.
\end{proof}

\begin{figure}[h!]
	\centering
	\includesvg[pretex=\tiny, width = 0.8\textwidth]{figures/bookembedding_preserved_face.svg}
	\caption[Book-embedding of a preserved face]{A book-embedding of a preserved face  with a vortex on the face. The green vertices are the boundary of the face and the other coloured vertices are distinct vertices in each bag. The bag is the red circle. This graph can be embedded on $3$ pages as the depth of the vortex attached is 2. }\label{fig:preserved_face}
\end{figure}

\begin{lemma}\label{lem:vortices_mono_paths}
	Suppose \(G\) is a graph where $G = G_0 \cup G_1$, where \(G_0\) is embedded on a surface \(\Sigma \) of genus \(g\). Let \(F\) be a face on \(G_0\). Let \(v_1, v_2, \ldots, v_k\) be the vertices bordering \(F\). Let \(D\) be a \(G\)-clean disk on \(F\). Now suppose \(G_1\) is a vortex of depth $k$ on \(D\) with a path-decomposition \((B_0, \ldots, B_l)\) and \(G_0\) has a book-embedding \((<, \varphi)\) on $s$ pages. Suppose there are at most \(m\) monochromatic paths for every face on $G_0$. Then \(G\) can be embedded on \(s + m(k+1)\) pages.
\end{lemma}

\cref{lem:vortices_mono_paths} implies \cref{corr:vortices_paths_pn}.

\begin{corollary}\label{corr:vortices_paths_pn}
	Suppose $G$ is a graph where $G = G_0 \cup G_1 \cup \ldots \cup G_P$, $G_0$ is embedded on a surface $\Sigma$ of genus $g$, and $G_1, \ldots ,G_P$ are vortices on $G_0$. Suppose further that $G_0$ has $m$ monochromatic paths on each of its faces on $\Sigma$. Then $G$ can be embedded on $s + pm(k+1)$ pages.
\end{corollary}

This is proven by adding $G_1, \ldots, G_P$ to $G_0$ one at a time and applying \cref{lem:vortices_mono_paths} each time. To prove \cref{lem:vortices_mono_paths}, we prove \cref{lem:one_page_decomposition}.
\begin{lemma}\label{lem:one_page_decomposition}
	Let \((B_1, \ldots, B_n)\) be a path-decomposition of \(G\) with path-width \(k\). Let \(x_1, \ldots, x_n\) be vertices in \(G\) such that \(x_i \in B_i\) for all \(i\), and suppose \(P\) is an induced path \((x_1, x_2, \ldots, x_n)\) in \(G\). Then for every one-page embedding of \(P\), \(G\) has a \((k + 1)\)-page embedding where $P$ is preserved in the book-embedding.
\end{lemma}
\begin{proof}
	The proof given is similar to the one in \cref{lem:preserved_faces_pagenumber}. 
	Suppose \(G\) has the structure as described in \cref{lem:vortices_mono_paths}. For each vertex \(v\) in \(G\), let \(\sigma(v)\) be the index of the first bag \(v\) appears in. Then in the book-embedding of \(G\), place all bags of \(v_i\) after \(x_i\) in the book-embedding, following the orientation of the path with the book-embedding. An example is in \cref{fig:preserving_pages}. Colour the edges like so:
	\begin{equation}
		c(uv) =
		\begin{cases}
			c(T_u) & \text{ if } \sigma(u) \leq \sigma(v), \\
			c(T_v) & \text{ if } \sigma(v) \leq \sigma(u).
		\end{cases}
	\end{equation}

	Then if two edges cross in the circular book-embedding, then they have different colours. Suppose that there are edges $vw$ and $pq$, and $c(vw) = c(pq)$.  Suppose without loss of generality that $\sigma(v) < \sigma(w) < \sigma(p) \leq \sigma(q)$. Consider the edge $x_{\sigma(w)-1} x_{\sigma(w)}$. This edge splits the one-page circular embedding into two region $R_1$, $R_2$. Two things can happen with the sub-paths $P[x_1,x_{\sigma(w) - 1}]$ and $P[x_{\sigma(w)}, x_n]$. Either both subpaths are in the same region, or are in opposite regions. An example is given in \cref{fig:preserving_pages}. If both subpaths are on opposite paths, then $v,w$ are on the boundary of $R_1$, and $p, q$ are on the boundary of $R_2$. Therefore, $vw, pq$ do not cross. If both paths are on the same side, then $vw$ will not cross $pq$, as there is no way to cross the path from $x_1$ to $x_{\sigma(w) - 1}$ without also forcing the page to be non-monochromatic. Therefore, $vw$, $pq$ do not cross. 
\end{proof}

\begin{figure}[h!]
	\centering
	\includesvg[pretex=\tiny, width = 0.8\textwidth]{figures/one_page_embedding.svg}
	\caption[One-page decomposition]{Description of \cref{lem:one_page_decomposition}. The path \(x_1, \ldots, x_n\) are on a single book-embedding and \(B_1, \ldots, B_n\) are the bags of the embedding. Notice that there are two different ways that the \(n + 1\)-th bag can end up, but both ways still maintain the property that this is a book-embedding. This diagram is a circular ordering of \(x_1, \ldots, x_n\).}\label{fig:preserving_pages}
\end{figure}
Having a one-page book-embedding of a path is useful because of the lemma above. The edge $x_{\sigma(w)-1} x_{\sigma(w)}$ splits the book-embedding into two regions. Therefore, we can force edges that are the same colour to not cross. 
We now prove \cref{lem:vortices_mono_paths}.
\begin{proof}
	Use the path-decomposition on \(G'\) as the set \((B_1, \ldots , B_n)\) in proving \cref{lem:vortices_mono_paths}. Then apply \cref{lem:one_page_decomposition} for the monochromatic \(v_i\) to each of the monochromatic paths. From the construction of the vortices in \cref{lem:preserved_faces_pagenumber}, add on the faces in the exact order. Then the monochromatic paths are preserved in the ordering, and in fact from \cref{lem:one_page_decomposition}, they are bounded.
\end{proof}

\begin{conjecture}\label{conj:nonorientable_monochromatic_paths}
	Every graph embedded on a surface of Euler genus $g$ can be embedded on $f(g)$ pages where every face has $h(g)$ monochromatic paths. 
\end{conjecture}

\cref{conj:nonorientable_monochromatic_paths} is a strengthening of \cref{conj:nonorientable}. We believe this holds for every surface, including the sphere.
\cref{conj:nonorientable_monochromatic_paths} implies the following:

\begin{corollary}\label{corr:aegraphs}
	If \cref{conj:nonorientable_monochromatic_paths} holds, then every $(g, p, k)$-almost-embeddable graph is embeddable on $h p (k + 1) + f$ pages, where $h = h(g)$ and $f = f(g)$ are from \cref{conj:nonorientable_monochromatic_paths}.
\end{corollary}

\begin{proof}
	Let $G$ be a $(g, p, k)$-almost-embeddable graph, on a non-orientable surface of genus $g$. By \cref{conj:nonorientable_monochromatic_paths}, there is a book-embedding of $G$ where every face has $h(g)$ monochromatic paths. Then by \cref{corr:vortices_paths_pn}, $G$ can be embedded in $f + h p (k+1)$ pages. 
\end{proof}

\cref{corr:aegraphs} implies \cref{conj:bded_had_pn}.
\begin{corollary}\label{corr:bound_gmst}
	If \cref{conj:nonorientable_monochromatic_paths} holds, then every $\mathcal{G}(g, p, k, a)$ graph can be embedded on $2s^2 + 4s + 1$ pages, where $s =  4g h (k + 1) + f + a$, where $h = h(g)$ and $f = f(g)$ are from \cref{conj:nonorientable_monochromatic_paths}. 
\end{corollary}

\begin{proof}
	Let $G \in \mathcal{G}(g, p, k, a)$. Then $G$ has a tree-decomposition where every torso is $(g, p, k, a)$-almost embeddable. From \cref{corr:aegraphs} and \cref{thm:apex_vertices_pagenumber}, every torso is embeddable on $s = 4g h (k + 1) + f + a$ pages. Then from \cref{corr:bded_pn_tree_decomp}, $G$ is embeddable on $2s^2 + 4s + 1$ pages.
\end{proof}

\begin{corollary}
	If \cref{conj:nonorientable_monochromatic_paths} holds, then every $K_t$-minor-free graph can be embedded on $f(t)$ pages. 
\end{corollary}

\begin{proof}
	Applying the Graph Minor Structure Theorem to \cref{corr:bound_gmst} every $K_t$-minor-free graph is in $\mathcal{G}(g, p, k, a)$ for some $g, p, k, a$ as a function of $t$. Therefore, every $K_t$-minor-free graph can be embedded on a bounded number of pages. 
\end{proof}

Therefore, finding a book-embedding of graphs on non-orientable surface with every face having a bounded number of monochromatic paths would prove \cref{conj:bded_had_pn}. Finding any book-embedding of graphs on non-orientable surfaces is difficult enough, and having the additional condition of monochromatic paths may be more difficult. Nevertheless, finding any bound will be useful.

A \textit{Hamiltonian path} $P$ on a graph $G$ is a path that visits every vertex in $G$ exactly once. A \textit{Hamiltonian cycle} $C$ on a graph $G$ is a cycle that visits every vertex in $G$ exactly once.  

A graph $G$ is \textit{Hamiltonian} if $G$ has a Hamiltonian cycle.
Firstly, \textcite{tutteTheoremPlanarGraphs1956} proves every $4$-connected planar graph is Hamiltonian.
In fact, there is a strengthening by \textcite{thomassenTheoremPathsPlanar1983}. A graph $G$ is \textit{Hamiltonian-connected} if for all edges $xy \in E(G)$, there is a Hamiltonian cycle that goes through $xy$. 

\begin{theorem}[\textcite{thomassenTheoremPathsPlanar1983}]\label{thm:4-connected_planar_ham_cycle}
	Every 4-connected planar graph is Hamiltonian-connected.
\end{theorem}


\begin{lemma}\label{lem:Hamiltonian_preserved_faces}
	Let \(G\) be a Hamiltonian planar graph with Hamiltonian cycle $C$. Then there exists a book-embedding $(\leq, \varphi)$ on two pages where every face of $G$ is preserved, and the circular ordering of $\leq$ is $C$.
\end{lemma}

\begin{proof}
	Let \(<\) be the circular ordering of these vertices by traversing \(C\). Now as \(G\) is planar, \(C\) splits the surface into an interior region and an exterior region, by the Jordan curve theorem. So every edge in $G - C$ is inside either the interior or exterior of \(C\). Colour every edge in $C$ and on the interior of $\mathbb{R}^2 - C$ red and colour the other edges blue. This is a book-embedding as both regions can be embedded on a single page with the same cyclic ordering. Furthermore, every face is preserved. Because $\mathbb{R}$ is orientable, affix an orientation to every face \(F\) on $G$ such that the order of the vertices in the orientation is the same order as the orientation in \(D\).
	\begin{figure}[h!]
		\centering
		\includesvg[pretex=\tiny, width=0.5\linewidth]{figures/hamiltonian-planar}
		\caption[Hamiltonian planar graph]{This is a Hamiltonian planar graph with a book-embedding of 2. The linear ordering is $v_1, v_2, \ldots,  v_8$. Let $C$ be the Hamiltonian cycle. The drawing of $C$ splits the plane into two regions. Then edges in the interior region and on $C$ are coloured red, and the remaining edges are blue. Now choosing any face and restricting the linear ordering to be around the face preserves each face. }\label{fig:hamiltonian_planar}
	\end{figure}
\end{proof}
From \cref{lem:Hamiltonian_preserved_faces}, if \(G\) is a Hamiltonian planar graph, then the vertex ordering of the Hamiltonian cycle \((\leq)\) preserves all faces on \(G\). As a consequence of \cref{thm:4-connected_planar_ham_cycle}, every 4-connected planar graph has a circular ordering which preserves every face.

Then this can be extended to every connected planar graph, adding a constant number of monochromatic paths, as shown by \cref{thm:planar_graph__be_mono_paths}.

We want to show that there exists a book-embedding of every planar graph where every face has a bounded number of monochromatic paths. We were able to prove it in the special case where every face has a bounded number of cut-sets of size 3 on its boundary. We assumed that every face has a bounded number of cut-sets of size 3 on its boundary, but this was not the case. \cref{fig:moved_vertices} provides a counterexample. 

We conjecture that every planar graph can be embedded on a bounded number of pages with a bounded number of monochromatic paths on each face. This will have to be a different book-embedding than the one given in \cref{thm:planar_graph__be_mono_paths}. The book-embedding given by \cref{thm:planar_graph__be_mono_paths} is not sufficient to prove this conjecture, because of \cref{fig:moved_vertices}.  

\begin{theorem}\label{thm:planar_graph__be_mono_paths}
	Let \( G \) be a planar graph embedded in $\mathbb{R}^2$, with every face having at most $k$ cut-sets of size $3$ on every face. Then $G$ can be embedded on 11 pages where every face has at most $8k$ monochromatic paths. 
\end{theorem}

$ ((T,r), (B_x)_x)$ is a tree-decomposition with $r$ as the root node. 

\begin{proof}
	Use \cref{lem:planar_graphs_4_connected_cliqesums} to build a tree-decomposition $((T,r), (B_x)_x)$ of $G$ with adhesion $3$. Every torso is either a $4$-connected planar graph or $K_t$ where $t \leq 4$.
	
	Every torso $G \langle B_x \rangle$ has a tree-decomposition where every face is preserved, from \cref{lem:Hamiltonian_preserved_faces}. Then apply \cref{thm:clique_sum_pagenumber_bound} to $((T,r), (B_x)_x)$ to embed $G$ in a book. The number of pages used is $2 \cdot 4 + 3 = 11$. 

	If $v$ is a cut-vertex of $G$, then $v$ is in an adhesion set of torsos $G \langle B_x \rangle$ and $G \langle B_y \rangle$. Assume that $B_y$ is the parent of $B_x$. Then from \cref{thm:clique_sum_pagenumber_bound}, the ordering does not change, so $v$ is not moved anywhere. Then any face $F$ where every vertex on the boundary of $F$ is in $B_x$ is preserved. Since the outerface of $B_x$ is preserved, the colour of the outerface can be changed so that it matches the colour of the face that $B_x$ is a part of. 

	Now suppose $S$ is an adhesion set between bags $B_x$ and the parent $B_y$. Suppose $ S = \{a,b\}$. Let $F$ be a face in $B_x$ and let $F_v$ be the set of vertices that touch $F$. Assume that $F_v \subseteq B_x$. If $F_v \cap S$ is nonempty, then $S$ vertices are moved to the start of $F$. 
	
	No vertex in $S$ is a cut vertex, because that would imply from \cref{lem:planar_graphs_4_connected_cliqesums} that $|S| = 1$. Let $(<_x, \psi_x)$ be a two-page book-embedding of $G \langle B_x \rangle$, from \cref{lem:Hamiltonian_preserved_faces}. Now $F$ has a single monochromatic face.
	From \cref{thm:4-connected_planar_ham_cycle}, there is a Hamiltonian cycle in $B_x$ with edge $ab$ on the cycle. From \cref{lem:Hamiltonian_preserved_faces}, this implies that $ab$ is consecutive on the cycle. From \cref{thm:clique_sum_pagenumber_bound}, this cycle is the same in $B_x$. If $ab$ is the boundary on a face $F$, then every face in $G[B_x \cup B_y]$ is contained in either $B_x$ or $B_y$. So every face is monochromatic. If $ab$ is a chord on a face $F$, $F$ lies in the subtree rooted at $B_x$ and $B_y$. Then $F$ can be coloured with a single monochromatic as we can cycle through colours of $B_x$ so that the colour of $F$ in $B_x$ and the colour of $F$ in $B_y$ matches. Then every face is preserved in the book-embedding. 

	If $S = \{u,v,w\}$, and if $u$ appears on a face $F$, then no vertices are moved around. If $u,v$ appear on a face $F$, then the edge $uv$ is in $B_x$. Then there is a face $F'$ in $B_x$ with the edge $uv$ on its boundary so that $F'$ is a part of $F$. But this means that there is a monochromatic path from $u$ to $v$. In this book-embedding, $u,v,w$ are moved to the very front. Then the edges of $u,v,w$ break the preserved face at $F$ and $F'$. Only the edges that $u$ and $v$ is adjacent to become different colours, meaning that the number of monochromatic paths at the end is $8$. 
	$u,v,w$ cannot all appear on a face $F$ as this implies that either $G$ is disconnected or there is a cutset of size $2$, breaking the condition that the cutsets are minimal. 
	Repeat for all cut-sets of size $3$ on the boundary of $F$, and as there are a bounded number of cutsets in $G$, then $F$ has $8k$ monochromatic paths.

\end{proof}	


There is no restriction on the number of planar graphs with cut-sets of size $3$.  There may be an unbounded number of vertices moved from \cref{thm:clique_sum_pagenumber_bound}, meaning that the number of monochromatic paths that are generated may be unbounded. An example of such a graph is in \cref{fig:moved_vertices}. There may be book-embedding of planar graphs where the number of monochromatic paths is bounded, but the method shown by \cref{thm:planar_graph__be_mono_paths} does not provide such a book-embedding. 

Look at \cref{fig:moved_vertices}. Let $T$ be a 4-connected torso with cut-set $\{u,v,w\}$. Note that even after applying \cref{thm:4-connected_planar_ham_cycle}, one of the vertices $u,v,w$ will have to be moved to the front of the book-embedding. 
Let $F$ be a face. Then $F$ can have an unbounded number of blue torsos on its boundary.  There may be some face with an unbounded number of monochromatic paths.


\begin{figure}[h!]
	\centering
	\includesvg[pretex=\tiny, width=0.5\linewidth]{figures/counterexample.svg}
	\caption[Counterexample to bounded number of moved vertices]{This is an example of a planar graph $G$ with faces that require an unbounded number of vertices. The red path is a Hamiltonian cycle through a torso of $G$ embedded on the annulus. The blue shapes are $4$-connected components, with cut-sets the green vertices on the ends.}\label{fig:moved_vertices}
\end{figure}