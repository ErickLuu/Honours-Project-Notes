% !TEX root = ./thesis.tex

\section{Bounded treewidth and page number}\label{sec:Bounded_Treewidth}
\begin{theorem}[\textcite{ganleyPagenumberTrees2001}]\label{thm:bded_treewidth_bded_pagenumber}
	Every graph \(G\) with \(\tw(G) \leq k\) can be embedded on $k + 1$ pages.
\end{theorem}
\textcite{ganleyPagenumberTrees2001} considered the case where \(G\) is a \(k\)-tree. We will bypass using \(k\)-trees and consider a tree-decomposition of \(G\) directly.

\begin{proof}
	Consider a tree-decomposition of \(G\), $\{B_x: x \in V(T)\}$. Perform a depth-first search on \(T\), starting at an arbitrary root node \(r\). Let \(\sigma(v)\) of a vertex \(v\) in \(V(G)\) be the first time \(v \in B_x\), $x \in T$ appears in the depth-first search. $\sigma(v)$ determines when $v$ appears in the book-embedding. Within each bag $B_x$, if two vertices $v,w$ first appear in $B_x$, then $v$ and $w$ are ordered arbitrarily in the book-embedding. Now consider the subtree \(T_v\) induced by the bags \(B_x\) containing \(v\). Let \(H\) be the intersection graph of the subtrees, where \(V(H) = \lbrace T_v : v \in G \rbrace\) and \(T_u T_v \in E(H)\) if there exists a bag \(B_x\) such that \(u, v \in B_x\). \(H\) is perfect as all intersection graphs of subtrees are perfect. Therefore, \(\chi(H) = \omega(H)\). Then as \(\tw(G) \leq k + 1\), then the size of a clique in \(H\) is at most \(k + 1\). Thus \(H\) is \(k + 1\)-colourable. Let $z: V(H) \rightarrow [k + 1]$ be a proper colouring of $H$. 
	\paragraph{}
	Then we assign the edges of \(G\) a colour. Colour each edge \(uv \in E(G)\) as follows:
	\begin{equation}
		c(uv) =
		\begin{cases}
			z(T_u) & \text{ if } \sigma(u) \leq \sigma(v), \\
			z(T_v) & \text{ if } \sigma(v) \leq \sigma(u)
		\end{cases}
	\end{equation}
	This is a proper book-embedding of \(G\). Suppose that edges \(uv\), \(xy\) cross, so \(\sigma(u) \leq \sigma(x) \leq \sigma(v) \leq \sigma(y)\). However, this implies that there exists a bag \(B\) such that \(u, x, v \in B\), as \(uv\) is an edge in \(B\) and we do a depth-first search to establish the ordering of $\sigma(u)$. So \(u, x, v\) they are in the same bags. However, this implies that the trees \(T_u\) and \(T_x\) intersect, meaning that \(c(uv) \neq c(xy)\). Therefore, all crossing edges are assigned different colours. Finally, the number of pages used is \(\chi(H) = k + 1\), so \(\pn(G) \leq k + 1\). Thus shown.
\end{proof}
\textcite{dujmovicGraphTreewidthGeometric2007} showed that when $k \leq 2$, all graphs with treewidth $k$ can be embedded on $k$ pages. However, when $k \geq 3$, there exist graphs with treewidth $k$ that cannot be embedded on $k$ pages. Therefore, when $k \geq 3$, the bound from \textcite{ganleyPagenumberTrees2001} is tight. 
For a simpler example, consider the case when $T$ is a path. The proof given below is identical to \cref{thm:bded_treewidth_bded_pagenumber}.

\begin{theorem}
	Every graph \(G\) with \(\pw(G) \leq k\) can be embedded on $k + 1$ pages.
\end{theorem}

\begin{proof}[Proof sketch]
	Let $G$ have path-decomposition $\{B_1, B_2, \ldots , B_k\}$. Let $\sigma(v)$ be the smallest $i$ such that $v \in B_i$. Colour each vertex such that in each bag, no two vertices are assigned the same colour. This is possible to do in $k+1$ colours as interval intersection graphs are perfect. Then colour edges such that edge $uv$ has the same colour as $u$ if $u \leq v$ in the book-embedding. This is a proper book-embedding.
\end{proof}

\subsection{Planar graphs}\label{ssec:Planar_Graphs}
\begin{theorem}[\textcite{yannakakisEmbeddingPlanarGraphs1989}]\label{thm:4Pages_Planar}
	All planar graphs can be embedded on four pages.
\end{theorem}
From \cref{thm:Planar Graph Hickingbotham Bound}, it was shown all planar graphs can be embedded on $11$ pages. However, the proof given by Yannakakis is tight, as there exist planar graphs that need four pages, from \textcite{yannakakisPlanarGraphsThat2020, kaufmannFourPagesAre2020}. We need the fact that the number of pages to embed a planar graph is bounded for proving that graphs embedded on a surface of bounded genus has bounded pagenumber.

\section{Graphs embedded on a surface of bounded genus}\label{sec:pagenumber_bounded_genus}

\begin{theorem}[\textcite{heathPagenumberGenusGraphs1992}]\label{thm:Genus_pagenumber_bound}
	For all graphs \(G\) of genus $g$, $G$ can be embedded in $18g$ pages.
\end{theorem}
Note that this bound extends the one found by \textcite{yannakakisEmbeddingPlanarGraphs1989} to graph families of bounded genus.
The best known bound is \(O(\sqrt{g})\), found by \textcite{malitzGenusGraphsHave1994}. This is best possible as complete graphs $K_n$ have pagenumber $O(n)$ but have genus $O(n^2)$, from Ringel and Young\cite{ringelMapColorTheorem1974}. Therefore if $K_n$ has genus $g$ then the pagenumber of $K_n$ is $O(\sqrt{g})$.

Let $G$ be a graph and $\Sigma$ be a surface. In this section, embedding $G$ in a book is referred to as the \textit{layout} of $G$. Embedding $G$ in $\Sigma$ is referred to as the \textit{embedding} of $G$ in $\Sigma$. The orientable genus of a graph \(G\), denoted \(\gamma(G)\), is the minimum genus of an orientable surface $\Sigma$ such that $G$ has an embedding on $\Sigma$. The nonorientable genus of a graph \(G\), denoted \(\tilde{\gamma}(G)\), is the minimum genus of a non-orientable surface $\Sigma$ such that $G$ has an embedding on $\Sigma$.\ \textcite{moharOrientableGenusGraphs1998} showed that \(\tilde{\gamma}(G) \leq 2 \gamma(G) + 1\) for all graphs, meaning that if the orientable genus is bounded, then the non-orientable genus is bounded.\ \textcite{auslanderImbeddingGraphsManifolds1963} showed that there exists graphs which are embeddable on the projective plane that have arbitrarily large orientable genus. In fact, there exists a family of graphs such that $\tilde{\gamma}(G) \in \Omega(|V(G)|)$ for all graphs $G$ in the family. Consider $n$ copies of $K_6$ with a single vertex in each copy identified to a single vertex. Then each $K_6$ will occupy a single crosscap with no room for another copy of $K_6$ to fit. Therefore, this graph is of non-orientable genus $2n$. 

\subsection{Proving \cref{thm:Genus_pagenumber_bound}}
An embedding of a graph $G$ on a surface $\Sigma$ is \textit{$2$-cell} if every face is homeomorphic to an open disc $D^2$. If $G$ is of genus $g$, then there exists a \textit{$2$-cell} embedding of $G$ to a surface of genus $g$. 

Let $G$ be a graph of genus $g$.
Heath and Istrail partition the edge-set of \(G\) to a planar spanning subgraph \(G_p\) and set of nonplanar edges $E_N$. This partition has the following properties:
\begin{enumerate}
	\item There exists a face $F_0$ in the embedding of $G_p$,
	\item all edges in \(E_N\) are between vertices on the boundary of $F_0$, and
	\item adding any edge from $E_N$ to \(G_p\) breaks the conditions above.
\end{enumerate}
$G_p$ is a maximal planar subgraph with respect to the conditions above. Through some stereographic projection from $S^2$ to $\mathbb{R}^2$, $F_0$ will be assumed to be the outerface. The set $(G_p, E_N)$ is a planar-nonplanar decomposition of $G$. 
% To talk about graphs embedded in surfaces, we assign to each face a cyclic permutation \(\sigma_v\) which represents the sequence of vertices encountered when traversing the boundary of a face in counterclockwise order.

% $\sigma_v$ enough to represent any graph in an orientable surface, but not enough for a non-orientable surface. We have to attach on an orientation to each edge, where each edge is either orientation-preserving or orientation-reversing.

% A planar-nonplanar decomposition of \(G\) is a triple \((R, G_P, E_N)\) where \(R\) is a rotation of \(G\) representing the surface embedding on the surface \(S\), \(G\) is a spanning planar graph, and \(E_N = E - E(G_P)\).
% This satisfies a list of properties:
% \begin{enumerate}
% 	\item The subrotation induces a planar embedding of \(G_p\), so we can arrange \(G\) on the surface \(S\) such that the embedding of \(G_p\) is planar.
%	\item For each \(vw \in E_N\), \(v\) and \(w\) live on the outerface \(F_0\).
%	\item \(E(G_P)\) is maximal, so we cannot add edges from \(E_N\) to \(G_P\) without breaking properties 1 and 2.
%\end{enumerate}

\subsubsection{Decomposing graphs on surfaces}\label{sssec:Planar_nonplanar_decomp}

\begin{claim}
	There exists a planar-nonplanar decomposition of any graph $G$ embedded on a surface $\Sigma$. 
\end{claim}
\begin{proof}
	Suppose \(G\) is embedded on an surface \(\Sigma\). Triangulate \(G\) to form \(G_T\). Start at a single triangle and define this triangle as $G_p$. Add edges and vertices to the planar part incrementally. At each step, set \(G_P\) to be the current planar part and \(E_N\) to be the edges that are outside the planar part. There are two types of edges in \(E_N\): edges which have both endpoints on the boundary \(V(G_P)\), so cannot become edges of \(G_P\), and edges that have either one or no endpoints in \(V(G_P)\).
	
	We want to maintain the property that if \(v \in G_P\), and edge \(vw \in E_n\), then \(v\) is a vertex on the boundary of \(G_p\).
	\paragraph{Adding vertices to biconnected block}
	Suppose $F$ is the outerface of \(G_P\). Define an oriented walk around the boundary $F$ to be a trace. If \(v_i \rightarrow v_j \rightarrow v_k\) is a walk with no edge of \(E_N\) incident to \(v_j\), then \(v_i v_k \in E(G_T)\) is called a safe edge. If \(v_i \rightarrow v_j\) is on the boundary of \(G_P\), and \(v_k \notin V(G_P)\), and \(v_i,v_j,v_k\) is the boundary of a face, then \(v_k\) is a safe vertex and can be added to \(G_P\). Add as many vertices $v_k$ as possible. 
	\paragraph{Creating new biconnected block}
	If no \(v_k\) exists, then find a \(w'\) which is the newest vertex in \(V(G_P)\) adjacent to a vertex \(w\) not in \(V(G_P)\). Add the vertex \(w\) and the edge \(w w'\) to \(G_P\). Then add all safe edges. This is so that every edge in \(E_p\) maintains the property that both endpoints are on the boundary.
	
	After repeating this operation, every edge in \(E_N\) satisfy the two properties above. If an edge \(vw\) has \(v\) in $G_p$ and $w$ not in $G_p$, then at some step \(w\) is added as a safe vertex or biconnected block. If an edge \(vw\) has neither \(v\) or \(w\) added to \(G_P\), then the algorithm has not finished yet. By connectivity, we can add \(v\) and \(w\) at some stage. This has the corollary that every vertex is in \(G_P\).
	
	Now every edge in \(E_N\) cannot be added to \(G_P\) without crossing over another edge, and \(G_P\) is maximal. Therefore, all edges in \(E_N\) satisfy the conditions listed above.
	\todo{Add pictures! this proof needs lots of pictures}
\end{proof}

\subsubsection{Level sets and cycles}
On a planar graph \(G\), we want to separate out vertices depending on how far away they are from the outerface. Fix a single outerface \(F_0\) and define the first level set \(V_0\) as the vertices adjacent to \(F_0\). Define the \(i\)-th level set, \(V_i\) inductively. Consider the induced graph on \(V(G) - \cup_{k = 0}^{i-1} V_k\). Define the vertices adjacent to \(F_0\) in this induced graph, where we expand \(F_0\) after deleting the vertices. This partitions \(V(G)\).

We then define \(C_0\) to be the edges adjacent to \(F_0\) in this decomposition. Then we want \(C_i\) to be the edges adjacent to \(F_0\) in this decomposition. We define the chord edges \(K_i\) to be the edges between vertices in \(V_i\) that are not edges in \(C_i\). Finally, we define the edges between faces, \(E_i\) as the edges that are between vertices on level \(V_i\) and \(V_{i + 1}\).

\begin{claim}
	For all faces \(F\) in \(G\), the vertices around \(F\) are either all in one \(C_i\) or they are in \(C_i\) and \(C_{i + 1}\) for some \(i\).
\end{claim}

\begin{proof}
	Let \(i\) be the smallest value such that \(v \in V_i\) is on the boundary of \(F\). Now \(G[V(G) - \cup_{j = 1}^{i} V_i]\) will also remove \(v\). However, this removes all the edges next to \(v\), therefore all vertices that are on the boundary of \(F\) will either be in \(V_i\) or \(V_{i + 1}\).
\end{proof}
We refer to the faces that have vertices in only \(V_i\) as chordal and the faces that are between \(V_i\) and \(V_{i + 1}\) as non-chordal.

We define a weak triangulation of \(G\) to be a triangulation \(G'\) such that all faces except for the outerface is a triangulation.
\begin{claim}
	There exists a weak triangulation $G'$ of \(G\) that preserves the level sets \(V_i\) and edge sets \(E_i\), \(C_i\), \(K_i\) for all \(i\).
\end{claim}

\begin{proof}
	If \(F\) is a chordal face of \(G\), then any triangulation maintains the property. If \(F\) is nonchordal and the boundary has edges in \(V_i\) and \(V_{i + 1}\), then add edges that are only between vertices in \(V_i\) and \(V_{i + 1}\). This will suffice to build a new triangulated graph \(G'\) where all vertices and edges are in the correct place.
\end{proof}

\subsubsection{Classifying nonplanar edges according to homotopy class}

Form a directed cycle \(C_0\) induced by \(F_0\). Each vertex on the boundary of \(F_0\) appears at least once, and twice if the vertex is an \textit{articulation point}, meaning the vertex separates biconnected components. Each edge on the boundary of \(F_0\) is encountered at least once on this cycle. Heath and Istrail refer to a directed subpath of the cycle \(C_0\) as a \textit{trace}. Let \(T = v_1 \rightarrow v_2 \rightarrow \cdots \rightarrow v_t\) be a trace. The inverse trace is \(T^{-1} = v_t \rightarrow v_{t-1} \rightarrow \cdots \rightarrow v_1\). Let us partition \(E_N\) into equivalence classes. Suppose that \(u_1v_1, u_2v_2 \in E_N\) are part of the boundary of the same face \(F\) on the embedding of \(G\). Then \(u_1v_1\) and \(u_2v_2\) are \textit{homotopic} (with respect to \(F\)) if:
\begin{enumerate}
	\item \(u_1v_1\) and \(u_2v_2\) are the only edges of \(E_N\) on the boundary of \(F\)
	\item There exist traces \(T_u = u_1 \rightarrow \cdots \rightarrow u_2\) and \(T_v = v_1 \rightarrow \cdots \rightarrow v_2\) such that \(T_u\) and \(T_v\) are on the boundary of \(F\).
\end{enumerate}
We may think of \(G_n\) as living on a disk on \(S\) and the homotopy class \(u_1v_1\) and \(u_2 v_2\) living on a handle (alternatively, passing through a crosscap such that they bound a face). Then if we take \(G_n\) to a point, there exists a \textit{homotopy} (in the topological sense) from \(u_1v_1\) to \(u_2v_2\). The definition above can be extended to form equivalence classes of the nonplanar edges.

\begin{claim}
	If \(C\) is a homotopy class of edges \(u_1 v_1, \ldots, u_k v_k\) with a natural order, then we can build traces \(T_1\) and \(T_2\) by building the trace from \(u_1\) to \(u_k\) passing through all \(u_i\), and \(v_1\) to \(v_k\) passing through all \(v_i\).
\end{claim}
Two traces $(T_1, T_2)$ are orientable if \(T_1\) and \(T_2\) go in opposite directions, and non-orientable if \(T_1\) and \(T_2\) go in the same direction.

\begin{lemma}
	Let $G$ be a graph. If \(G\) is embedded in an orientable surface, then every homotopy class is orientable.
\end{lemma}
\begin{proof}
	This proof is a sketch of the full argument. If a homotopy class is non-orientable, then on the handle the class sits on, the edges must cross. However, the graph is embedded on the surface, therefore the graph on the surface can be viewed as a topological orientable polygon. Therefore, the traces must be orientable.
\end{proof}

\begin{lemma}
	Let $G$ be a graph. If \(G\) is \(2\)-cell embedded on a surface of Euler genus \(g\), then any planar-nonplanar decomposition has at most \(3g-3\) homotopy classes.
\end{lemma}
\begin{proof}
	Decompose \(G\) to a \((G_P, E_N)\) decomposition of \(G\). Suppose \(E_N \neq \emptyset\). Then identify \(G_P\) to a single point, and identify each homotopy class to a single edge. Then draw a circle around the point \(G_P\), and place vertices where the circle intersects all edges. Then delete the vertex \(G_P\), and call the new graph \(H\). Then \(n = |V(H)|\), \(m = |E(H)|\), where \(h\) is the number of homotopy classes, and \(f\) is the number of faces. From Euler's theorem on surfaces, \(n - m + f = 2 - g\). Since \(H\) is cubic as every vertex has two edges on the circle and one on the homotopy class, then \(3n = 2m\) by the handshaking lemma. Since there is only one nonplanar edge for each homotopy class, \(n = 2h\). The interior face of \(H\) has \(v\) incident edges, and the remaining \(f-1\) faces have at least 3 incident edges each. If a face has four edges, then the two nonplanar edges are homotopy equivalent. Therefore, \(3(f-1) + n \leq 2m\), by double counting faces and edges. Thus,
	\begin{align*}
		3n  & \geq 6(f - 1) + n         \\
		2n  & \geq 6f + 6               \\
		\\
		4h  & \geq 5 f - 6              \\
		4h  & \geq 5(2 - g + m - n) - 6 \\
		4h  & \geq 6 - 6g + 3n          \\
		4h  & \geq 6 - 6g + 6h          \\
		-2h & \geq 6 - 6g               \\
		h   & \leq 3g - 3
	\end{align*}
	Therefore, \(h \leq 3g - 3 \) by manipulating the inequalities.
\end{proof}

\subsubsection{Proving graphs with bounded number of homotopy classes have bounded pagenumber}\label{sssec:bounded_pagenumber_homotopy}
A cut-vertex $v$ in a connected graph $G$ has the property that $G - v$ is disconnected.
A subgraph $H$ of a graph $G$ is a \textit{block} if:
\begin{itemize}
	\item $H$ is a maximal biconnected component of $G$,
	\item $H$ is a bridge edge of $G$ with its two endpoints or
	\item $H$ is an isolated vertex.
\end{itemize}

\begin{theorem}
	For all graphs $G$, blocks partition $E(G)$.
\end{theorem}

A \textit{block-cut tree} is a tree $T$ whose vertices are the blocks and cut-vertices of $G$, and $uv$ is an edge in $T$ whenever one block is adjacent to a cut-vertex. This definition is important in the next section.
\begin{lemma}\label{lem:planar_nonplanar_orientable}
	Suppose a graph \(G\) has a planar-nonplanar decomposition \((G_P, E_N)\) on an orientable surface \(\Sigma\) of genus $g$. Then \(G\) can be embedded on at most \(18g - 5\) pages.
\end{lemma}
\begin{proof}
	\textcite{yannakakisEmbeddingPlanarGraphs1989} has a method to lay out the planar spanning subgraph \(G_P\) on four pages. The layout also preserves the ordering of vertices when traversing the boundary of the outerface. For each homotopy class in \(E_P\), we allocate three pages. One page is for vertices in the same block, and the other two pages are used for edges between blocks. Therefore, we need at most \(4 + 3(6g - 3) = 18g-5\) pages if \(G\) has a planar-nonplanar decomposition.
\end{proof}