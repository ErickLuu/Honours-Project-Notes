\section{Almost-Embeddable Graphs on orientable surfaces}

We wish to find a book-embedding of an almost-embeddable graph on some orientable surface. 
Recall the definition of $(g, p, k, a)$-almost-embeddable from \cref{ssec:Robertson_Seymour_Graph_Structure}. A graph $G$ is $(g, p, k)$-almost-embeddable if $G$ is $(g, p, k, a)$-almost-embeddable and $a = 0$, so $G$ has no apex set.
What we plan to show is this:
\begin{theorem}\label{thm:bounded_almost_embeddable}
	Suppose $G$ is $(g, p, k)$-almost embeddable on an orientable surface. Then $G$ can be embedded on \(f(g, p, k)\) pages for some function $f$.
\end{theorem}

The most problematic section is dealing with vortices on surfaces.
To work with vortices, consider how an ordering affects the face that the vortex is sitting on. Then see what happens when the vortex is added onto the face. 

To solve this problem, we define some new concepts. Let \(G\) be a graph. A vertex ordering \((<)\) \textit{preserves} a face \(F\) if there is a vertex \(v_0\) on the boundary of \(F\) and a vertex ordering \((v_0, v_1, \ldots, v_k)\) around the boundary of \(F\) such that \(v_0 < v_1 < \cdots < v_k\).
A circular ordering \(<\) preserves a face \(F\) if the induced linear ordering has the condition above. Preservation of faces 
Let \(F\) be a face on \(G\). Let \( (<, \varphi) \) be a book-embedding of \(G\). A \textit{monochromatic path} $P$ on the boundary of $F$ is a maximal path where every edge is in the preimage of some colour in $\varphi$.

\begin{figure}[h!]
	\centering
	\includesvg[width = 0.5 \textwidth]{figures/monochromatic_paths.svg}
	\caption[Monochromatic paths]{An example of a monochromatic path on a face. Above is a face embedded on $\mathbb{R}^2$. Around in some book-embedding are some edges coloured red and blue. This face has four monochromatic paths. Below is a circular ordering of the vertices on the boundary of the face. Every edge coloured red is embedded on a single page.}
\end{figure}


The list below are the steps taken to prove \cref{thm:bounded_almost_embeddable}.
\begin{enumerate}
	\item Let $G$ be a \(4\)-connected planar graph. There is a book-embedding where every book is monochromatic. 
	\item Suppose \(G\) is a connected planar graph. Faces are not preserved, but a fixed number of vertices are moved around on every face. Additional pages are necessary to embed $G$, but the number of monochromatic paths is bounded. 
	\item Suppose \(G\) is $2$-cell embedded on a surface. \textcite{heathPagenumberGenusGraphs1992} gives a planar-nonplanar decomposition to find a spanning planar subgraph of $G$ and nonplanar edges. Then apply the previous steps to the spanning planar subgraph.
\end{enumerate}

\subsection{Faces and Monochromatic paths}

Preserved faces allow us to embed vortices with a bounded number of pages. 

\begin{lemma}[Vortex on preserved faces]\label{lem:preserved_faces_pagenumber}
	Suppose a graph \(G\) has partition \(G = G_0 \cup G_1\), where \(G_0\) is embedded on a surface $\Sigma$ and \(G_1\) is a vortex on a face $F$ of $G_0$ with depth \(k\). Suppose $(<, \varphi)$ is a $p$-page book-embedding of \(G_0\) which preserves \(F\). Then $G$ can be embedded on \(p + k + 1\) pages. Furthermore, the new ordering restricted to $G_0$ is $(<, \varphi)$.
\end{lemma}

\begin{proof}
	We repeat a similar argument to \cref{thm:bded_treewidth_bded_pagenumber}. Let \(B_1, \ldots, B_i\) be the path-decomposition of \(G_1\). Let \(\sigma(v)\) be the first time \(v\) appears in the path-decomposition. Colour the edges of \(G_1\) as such. If \(uv \in E(G_1)\), then:
	\begin{equation}
		c(uv) =
		\begin{cases}
			c(T_u) & \text{ if } \sigma(u) \leq \sigma(v), \\
			c(T_v) & \text{ if } \sigma(v) \leq \sigma(u)
		\end{cases}
	\end{equation}
	then is a book-embedding of \(G_1\) with \(k+1\) colours for the same reason as \cref{thm:bded_treewidth_bded_pagenumber}.
	To add this book-embedding to \(G_0\), add the vertices that appear first in \(B_i\) after the associated vertex \(v_i\) in \(G_0\) such that \(v_i\) is on the face \(F\) and \(v_i \in B_i\). This is a book-embedding of \(G\) requiring at most \(\pn(G_0) + k + 1\) colours. An illustration of such a book-embedding is in \cref{fig:preserved_face}.
\end{proof}

\begin{figure}[h!]
	\centering
	\includesvg[pretex=\tiny, width = 0.8 \textwidth]{figures/bookembedding_preserved_face.svg}
	\caption[Book-embedding of a preserved face]{A book-embedding of a preserved face (vertices $v_1, \ldots , v_8$) with a vortex on the face. This graph can be embedded on $3$ pages as the depth of the vortex attached is 3. }\label{fig:preserved_face}
\end{figure}

\begin{lemma}\label{lem:vortices_mono_paths}
	Suppose \(G\) is a graph with components \(G_0\) and \(G_1\). Suppose \(G_0\) is embedded on a surface \(\Sigma \) of genus \(g\) and let \(F\) be a face on \(G_0\). Let \(v_1, v_2, \ldots, v_k\) be the vertices bordering \(F\), and let \(C\) be the cycle bordering \(F\). Let \(D\) be a \(G\)-clean disk on \(F\). Now suppose \(G_1\) is a vortex of depth $k$ on \(D\) with a path-decomposition \((B_0, \ldots, B_l)\) and \(G_0\) has a book-embedding \((<, \varphi)\) on $s$ pages. Suppose there are \(m\) monochromatic paths for every face on $G_0$. Then \(G\) can be embedded on \(s + m(k+1)\) pages.
\end{lemma}

\cref{lem:vortices_mono_paths} implies \cref{corr:vortices_paths_pn}.

\begin{corollary}\label{corr:vortices_paths_pn}
	Suppose $G$ is a graph with components $G_0, G_1, \ldots, G_p$ such that $V(G) = V(G_0) \cup V_(G_1) \cup \ldots \cup V_(G_p)$, $G_0$ is embedded on a surface $\Sigma$ of genus $g$, and $G_1, \ldots G_p$ are vortices on $G_0$. Suppose further that $G_0$ has $m$ monochromatic paths on each of its faces on $\Sigma$. Then $G$ can be embedded on $s + pm(k+1)$ faces.
\end{corollary}

This is proven by adding $G_1, \ldots, G_p$ to $G_0$ one at a time and running \cref{lem:vortices_mono_paths} each time. 

We shall prove an intermediate lemma.
\begin{lemma}\label{lem:one_page_decomposition}
	Let \((B_1, \ldots, B_n)\) be a path-decomposition of \(G\) with path-width \(k\). Let \(x_1, \ldots, x_n\) be vertices in \(G\) such that \(x_i \in B_i\) for all \(i\), and suppose \(P\) is an induced path \((x_1, x_2, \ldots, x_n)\) in \(G\). Then for every one-page embedding of \(P\), \(G\) has a \((k + 1)\)-page embedding.
\end{lemma}
\begin{proof}
	The proof given is similar to the one in \cref{lem:preserved_faces_pagenumber}. 
	Suppose \(G\) has the structure as described in \cref{lem:vortices_mono_paths}. For each vertex \(v\) in \(G\), let \(\sigma(v)\) be the index of the first bag \(v\) appears in. Then in the book-embedding of \(G\), place all bags of \(v_i\) after \(x_i\) in the book-embedding, following the orientation of the path with the book-embedding. Colour the edges in the same way above: 
	\begin{equation}
		c(uv) =
		\begin{cases}
			c(T_u) & \text{ if } \sigma(u) \leq \sigma(v), \\
			c(T_v) & \text{ if } \sigma(v) \leq \sigma(u)
		\end{cases}.
	\end{equation}

	Then if two edges cross in the book-embedding, then they have different colours. If two edges cross, then that implies that in a book-embedding of the path \(P\) with \((B_1, \ldots, B_n)\) added in like \cref{lem:preserved_faces_pagenumber}, then they will cross as well. But as that that implies they have different colours, then in this new embedding they have different colours as well. Two examples are given in \cref{fig:preserving_pages}.
	This is a small tweak of \cref{lem:preserved_faces_pagenumber}. 
\end{proof}

\begin{figure}[h!]
	\centering
	\includesvg[pretex=\tiny, width = 0.8 \textwidth]{figures/one_page_embedding.svg}
	\caption[One-page decomposition]{Description of \cref{lem:one_page_decomposition}.\(x_1, \ldots, x_n\) are the vertices with a path that is a single book-embedding and \(B_1, \ldots, B_n\) are the bags of the embedding. Notice that there are two different ways that the \(n + 1\)-th bag can end up, but both ways still maintain the property that this is a book-embedding. This diagram is a circular ordering of \(x_1, \ldots, x_n\). The reason a circular ordering was chosen was because circular orderings are more compact to draw. }\label{fig:preserving_pages}
\end{figure}

We shall now prove \cref{lem:vortices_mono_paths}.
\begin{proof}
	Use the path-decomposition on \(G'\) as the set \((B_1, \ldots , B_n)\) in proving \cref{lem:vortices_mono_paths}. Then apply \cref{lem:one_page_decomposition} for the monochromatic \(v_i\) to each of the monochromatic paths. From the construction of the vortices in \cref{lem:preserved_faces_pagenumber}, add on the faces in the exact order. Then the monochromatic paths are preserved in the ordering, and in fact from \cref{lem:one_page_decomposition}, they are bounded.
\end{proof}
\subsection{Planar graphs}
\begin{lemma}\label{lem:Hamiltonian_preserved_faces}
	Let \(G\) be a Hamiltonian planar graph. Then there exists a book-embedding $(\leq, \varphi)$ on two pages where every face of $G$ is preserved.
\end{lemma}

\begin{proof}
	Let \(C\) be the Hamiltonian cycle of \(G\). Let \(<\) be the circular ordering of these vertices by traversing \(C\). Now as \(G\) is planar, \(C\) splits the surface into an interior region and an exterior region, by the Jordan curve theorem. So every edge in $G - C$ is inside either the interior or exterior of \(C\). Colour every edge in $C$ and on the interior of $\mathbb{R}^2 - C$ red and colour the other edges blue. This is a book-embedding as both regions can be embedded on a single page with the same cyclic ordering. Furthermore, every face is preserved. Because $\mathbb{R}$ is orientable, affix an orientation to every face \(F\) on $G$ such that the order of the vertices in the orientation is the same order as the orientation in \(D\).
	\begin{figure}[h!]
		\centering
		\includesvg[pretex=\tiny, width=0.3\linewidth]{figures/hamiltonian-planar}
		\caption[Hamiltonian planar graph]{This is a Hamiltonian planar graph with a book-embedding of 2. The linear ordering is $v_1, v_2, \ldots,  v_8$. Let $C$ be the Hamiltonian cycle. $C$ splits the plane into two regions. Then edges in the interior region and on $C$ are coloured red, and the remaining edges are blue. Now choosing any face and restricting the linear ordering to be around the face preserves each face. }\label{fig:hamiltonian_planar}
	\end{figure}
\end{proof}
As a consequence, every 4-connected planar graph has a circular ordering which preserves every face.
First do a planar-nonplanar decomposition of \(G\).
Then decompose the planar subgraph \(G_p\) into 4-connected components with adhesion at most 3, from \cref{lem:planar_graphs_4_connected_cliqesums}.
From \textcite{tutteTheoremPlanarGraphs1956}, if \(G\) is a 4-connected planar graph, then the vertex ordering of the Hamiltonian cycle \((\leq)\) preserves all faces on \(G\).
In \cref{ssec:Clique_sum_Pagenumber_bound}, at most three vertices will be moved to the start of the decomposition. The number of pages needed to embed \(F\) is bounded.


\begin{theorem}\label{thm:embedded_graph}
	Let \( G \) be a planar graph embedded on $\mathbb{R}^2$. Then $G$ can be embedded on 11 pages where every face has at most $12$ monochromatic paths. 
\end{theorem}

\begin{proof}
	Use theorem \cref{lem:planar_graphs_4_connected_cliqesums} to build a tree-decomposition $(B_x : x \in T)$ of $G$ with $4$-connected planar torsos of adhesion 3. Each torso $G \langle B_x \rangle$ has a tree-decomposition where every face is preserved, from \cref{lem:Hamiltonian_preserved_faces}. Then apply \cref{thm:clique_sum_pagenumber_bound} to embed $G$ in a book. At most three vertices are moved to the front in each torso. By the construction of the $4$-connected planar graphs, every face $F$ has at most three vertices moved to the front. Each vertex moved forces two edges to be on an individual monochromatic path, and paths between front vertices are also changed. Therefore, every face has at most $12$ monochromatic paths, as each vertex adds at most four additional monochromatic paths. By \cref{thm:Planar Graph Hickingbotham Bound}, $G$ can be embedded on $11$ pages.
\end{proof}	