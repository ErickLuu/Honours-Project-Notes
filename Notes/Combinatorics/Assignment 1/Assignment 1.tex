\documentclass[]{article}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath}
\usepackage{amssymb}
%opening
\title{Assignment 1}
\author{Eric Luu}

\begin{document}

\maketitle
\section{Question 1}
\subsection{Part a}
\paragraph{$S_n$}
There is a bijection from $W_n$ to placing $k$ balls in $n$ urns labelled $1 .. n$. Label the set of ways to place $k$ balls in $n$ urns as $U_n$. We shall show that there is a bijective function $\psi: W_n \rightarrow U_n$. Let $[w_1, w_2, ..., w_{k}]$ be a sequence in $W_n$. Then  $\psi([w_1, w_2, ..., w_{k}])$ has that the $i$-th ball is in $U_{w_i}$. This is a bijective function. To show injectivity, if $\psi(a) = \psi(b)$, then since the urns are the same, then it must hold that sequence $a$ and $b$ have the same numbers and thus $a = b$ as they will be uniquely non-decreasing. Tp show surjectivity, if urn 1 contains $a_1$ balls, urn 2 contains $a_2$ balls, up to urn $n$ containing $a_n$ balls such that $\sum_{i = 1}^n a_n = k$, then the sequence $[1, 1, ..., 1, 2, 2, 2, ..., ... n, n, n]$ such that the number $i$ appears $a_i$ times in the sequence will be mapped to the urns. 
Therefore, $|W_n| = \binom{n + k - 1}{k}$. 
\paragraph{$S_n$}
There is a bijection from $S_n$ to choosing $k$ numbers in $[n]$. Suppose we have the numbers $[s_1, s_2, ... s_k]$. Then this will correspond to choosing the numbers $s_1, s_2, ..., s_k$ from $[n]$. This is injective as if two sequences choose the same numbers, as the sequences are increasing, the only way that this can happen is if the sequences are identical. Secondly, for every way to choose $k$ numbers from $[n]$, we order them smallest to largest to form a sequence in $S_n$. Thus the sequences we have are bijective.
Therefore, $|S_n| = \binom{n}{k}$. 
\subsection{Part b}
If we let $m = n + k - 1$, then we have that $|S_m| = \binom{n + k - 1}{k} = |W_n|$. 
\subsection{Part c}
We have that the function $\phi: S_{n + k - 1} \rightarrow W_n$, where it sends $[s_1, s_2, ..., s_{k}]$ to $[s_1, s_2 - 1, ..., s_{k} - k + 1]$, is a bijection. 
To show that this function is well-defined, we have that if $s_i < s_{i+1}$, then $s_i + 1 \leq s_{i + 1}$, therefore $s_i - i + 1 \leq s_{i + 1} - i$. However, we have that $s_i - i + 1$ is the $i$-th term that $s_i$ gets sent to and $s_{i + 1} - i$ is the $i + 1$-th term. Finally, we have that $1 \geq s_1$, and $s_k \leq n + k - 1$, therefore $ 1 \leq s_1 $ and $s_k + k - 1 \leq n$. Therefore we have that $[s_1, s_2 - 1, ..., s_{k} - k + 1] \in W_n$. 

To show injectivity, consider if $\phi([a_1, a_2, ... a_k]) = \phi([b_1, b_2, ..., b_k])$. Then $[a_1, a_2 -1, ..., a_k - k + 1] = [b_1, b_2 -1, ..., b_k - k + 1]$. However, this implies $a_1 = b_1, a_2 = b_2$ and so on. Thus these sequences are equal.
To show surjectivity, consider any sequence $[w_1, w_2, ... w_k]\in W_n$. Then the sequence $[w_1, w_2 + 1, w_3 + 2, ..., w_k + k - 1]$ is in $S_n$ as if $w_i \leq w_{i + 1}$, then $w_{i} + (i - 1) < w_i + (i)$, and $\phi([w_1, w_2 + 1, w_3 + 2, ..., w_k + k - 1]) = [w_1, w_2, ... w_k]$ . Therefore, $|S_{n + k - 1}| = |W_n|$ by this bijection. 
\section{Question 2}
\subsection{Part a}
We will introduce $U_{k, n}$, the set of arbitrary $k \times n$-sized Latin rectangles, and establish a relationship between $S_{k,n}$ and $U_{k,n}$. We can convert a rectangle in $U_{k,n}$ to one in $S_{k,n}$ by rearranging the column vectors such that the first row is in non-decreasing order, then rearranging the rows such that the first column is in non-decreasing order. At every step, we are presented with no choices, therefore all Latin rectangles in $U_{k,n}$ are mapped to a single rectangle in $S_{k,n}$. To see the inverse process, we permute $(k - 1)$ rows (except for the first) and then permute $n$ columns. This gives us $(k - 1)! n!$ switching operations and each Latin rectangle corresponds with a unique switching operation, thus we have that $|U_{k, n}| = (k - 1)! n! |S_{k, n}|$. However, we have that $|U_{k, n}| = \frac{(n - 1)! n!}{(n-k)!} |R_{k,n}|$, thus $\frac{(n - 1)! n!}{(n-k)!} |R_{k,n}|= (k - 1)! n! |S_{k, n}|$. Rearranging around the fraction, we have that:
\begin{align*}
	|S_{k, n}| &= \frac{(n - 1)!}{(n-k)!(k - 1)!} |R_{k,n}|\\
	&= \frac{(n - 1)! n k}{(n-k)!(k - 1)! n k} |R_{k,n}|\\
	&= \frac{n! k}{(n-k)! k! n} |R_{k, n}|\\
	|S_{k, n}| &= \frac{k}{n} \binom{n}{k} |R_{k, n}|
\end{align*}
\subsection{Part b}
We have that $|S_{2, n}|$ is the number of derangements of $[n]$, which satisfies the recurrence relationship $|S_{2, n}| = (n - 1) |S_{2, n-1}| + (n - 1)|S_{2, n-2}|$. Consider any derangement $\sigma$. If we have that $a = \sigma(n) = \sigma^{-1} n$, where $a$ is in $[n-1]$, then we remove $a$ and $n$ to generate a smaller derangement of size $n-2$. If $\sigma(n)$ and $\sigma^{-1}(n)$ are distinct, then we can remove $n$ and set $\sigma(n) = \sigma^{-1}(n)$, where we have $n-1$ choices of what the predecessor of $n$ is. This will yield a derangement of size $n-1$. Therefore, we have that $|S_{2, n}| = (n - 1) |S_{2, n-1}| + (n - 1)|S_{2, n-2}|$.

We have that $R_{2, n}$ is the number of derangements where $\sigma(1) = 2$. Consider $R_{2, n}$ and a derangement $\sigma$ where $\sigma(1) = 2$. Now consider removing $n$ in $\sigma$. The predecessor of $n$ is $\lbrace 2, 3, ..., n-1 \rbrace$ and the successor is $\lbrace 1, 3, 4, ... , n-1$. We have $n-3$ options for the predecessor being the same as the successor, as we exclude $\lbrace 1, 2, n \rbrace$. If the predecessor is not the successor, then we have $(n-2)$ predecessors that $n$ can be in front of, therefore removing $n$ and setting $\sigma^{-1}(n) = \sigma(n)$ yields a reduced Latin rectangle of size $n - 2$. Therefore, we have that
\begin{equation}
	|R_{2, n}| = (n - 3) |R_{2, n - 2}| + (n - 2) |R_{2, n-1}|
\end{equation}
We have that $|S_{2, n}| = \frac{2}{n} \binom{n}{2} |R_{2, n}| = (n-1) |R_{2,n}|$, from 2a. Therefore, $|R_{2, n}| = |S_{2, n}|/(n-1)$, therefore $|R_{2, n-1}| = |S_{2, n-1}|/(n-2)$ and $|R_{2, n-2}| = |S_{2, n-2}|/(n-3)$. Plugging it into the relation above, we have that $|S_{2, n}|/(n-1) = |S_{2, n-1}| + |S_{2, n-2}|$, which is the relation found above. Therefore, we have shown that we can deduce the recurrence in multiple ways. 


\section{Question 3}
We have that $T_{n, 0} = 1$, as there is only one way to arrange the students in nondecreasing order, as for each pair of twins, swapping the positions of the twins is identified with keeping the twins the same as they are identical. 
\paragraph{Recurrence}
We first note that the two shortest twins must be placed next to each other because as they are the shortest, then there are no taller pupils between them. 
For the size of $T_{n, k}$, we look at where the shortest twins are placed. We have that the twins can be placed behind of one of the other $2n - 2$ pupils, or they can go at the start. Then if they are placed behind a pupil, then when we remove the shortest twins, then we have that there are $n-1$ twins and exactly $k-1$ pupils in front of someone shorter. If the shortest twins are placed at the very start, then there are $n-1$ twins and $k$ pupils in front of someone shorter. Thus we have the recurrence:
\begin{equation}
	T_{(n, k)} = 2(n-1) T_{(n-1, k-1)} + T_{(n-1, k)}
\end{equation}
with the base case $T_{n, 0} = 1$. We also have an upper bound where $T_{1, 1} = 0$, which upper bounds the number of pupils
\section{Question 4}
Let $P_n$ be the number of queues of $n$ identical twins. Consider the permutations of $[2n]$ but we are allowed to swap $i$ and $n + i$ around, where $i \in [n]$. There are $(2n)!$ permutations, and for each pair of twins, we identify two permutations. Therefore, the fraction is:
\begin{equation}
	P_n = \frac{(2n)!}{2^n}
\end{equation}
The number of ways to choose $k$ nonconsecutive numbers from $[n]$ is $\binom{n - k + 1}{k}$. There is a bijection between choosing $k$ consecutive numbers in $[n]$ and the number of $n$-length strings of $0$ and $1$ such that no $1$ is adjacent to another $1$. Then this is a bijection to having $n-k$ zeroes where the numbers will not be chosen will go. Then we have $n - k + 1$ gaps where we will place the ones. Therefore, we have $\binom{n - k + 1}{k}$ ways to solve this equation. 
\par
Now consider $Q_n$, the number of queues where no two twins are next to each other. First, let $R_n$ be the number of permutations of $[2n]$ where $i$ and $n + i$ is not allowed to be next to each other ($i$ is also in $[n]$). We shall use the principle of inclusion-exclusion. Let $A := S_{2n}$ be the set of permutations of $[2n]$ and let $P_{i}$ be the property of permutation $\sigma$ where $i$ and $i + n$ are next to each other. We have that either $i$ or $n + i$ is first, the first number can go in $(2n - 1)$ places (we exclude the last position of the queue), and the other numbers can be, arbitrarily, in $(2n - 2)!$ permutations. The number of permutations where $i$, $i + 1$ are next to each other are $2(2n - 1) (2n - 2)! = 2 (2n - 1)!$. Suppose we choose $k$ pairs of twins, and look at the permutations where they are next to each other. Then we could put $k$ twins in any nonconsecutive positions. The number of ways to choose $k$ nonconsecutive numbers from $[2n-1]$ is $\binom{2n - k}{k}$. Thus, we choose any one of the $\binom{2n - k}{k}$ ways to choose $k$ consecutive numbers, choose from each pair of twins which twin goes first (which has $2^k$ choices), choose how to order the $k$ twins, leading to $k!$ choices, and order the other $(2n - 2k)!$ students. So the number of permutations with the property that $k$ twins are next to each other (and more) are:
\begin{equation}
	N_{\geq P_i} = \binom{2n - k}{k} 2^k k! (2n - 2k)! =  \frac{(2n - k)!}{k! (2n - 2k)!}2^k k! (2n - 2k)! = (2n - k)!2^k.
\end{equation}
There are $\binom{n}{k}$ choices for which we can choose the $k$ properties. From inclusion-exclusion, we have that:
\begin{align*}
	R_n &=  \sum_{k = 0}^n (-1)^k \binom{n}{k} (2n - k)!2^k\\ 
	&=  \sum_{k = 0}^n (-1)^k \frac{n!}{k! (n - k)!} (2n - k)!2^k\\
	&= \sum_{k = 0}^n (-1)^k \frac{n!(2n - k)! 2^k}{k! (n - k)!}
\end{align*}
We can relate $Q_n$ with $R_n$ with the same "trick" by identifying relations where we can swap around $i$ and $n+ i$, meaning that $Q_n = R_n/2^n$. 
\begin{equation}
	Q_n = \sum_{k = 0}^n (-1)^k \frac{n!(2n - k)! 2^{k - n}}{k! (n - k)!}
\end{equation}
\section{Question 5}
We have that there are $nk$ ones and $n(n-k)$ zeroes. 
Let $\mathcal{A}$ be the set of all $2 \times 2$ submatrices of $A$, and denote a submatrix of $A$ as $B$. Give exactly 1 property for every $1$ in the matrix $A$. 

Then we have that by PIE that:
\begin{equation}
	N_{=}(S_0) = \sum_{i= 0}^4 (-1)^{i} N_{\geq}(S_i) 
\end{equation}
Therefore, 
\begin{equation}
	N_{=}(S_0) = N_{\geq}(S_0) - N_{\geq}(S_1) + N_{\geq}(S_2) - N_{\geq}(S_3) + N_{\geq}(S_4)    
\end{equation}
but as we have that $N_{=}(S_4) = N_{\geq}(S_4) = m_1$, and $N_{=}(S_0) = m_0$, then we can write this equation as:
\begin{equation}
	m_0 - m_1 = N_{\geq}(S_0) - N_{\geq}(S_1) + N_{\geq}(S_2) - N_{\geq}(S_3)    
\end{equation}
We have that $N_{\geq}(S_0)$ is the number of submatrices, which is generated by choosing two rows and two columns and deleting everything else. Therefore, $N_{\geq}(S_0) = \binom{n}{2}\binom{n}{2}$.
\paragraph{$S_1$}
For $N_{\geq}(S_1)$, we have that the number of submatrices we want is the number of submatrices with a 1 as an entry. There are $kn$ entries with $1$ in $A$ and we can choose another $(n-1)$ row and $(n-1)$ columns, to have that $N_{\geq}(S_1) = kn(n-1)^2$.
\paragraph{$S_2$}
For the $N_{\geq}(S_2)$ case, choose one out of $n$ rows and choose two entries on that row that are 1. Then arbitrarily choose a row to have an entry such that there are two ones in a single row. We can choose $n$ rows and $\binom{k}{2}$ ones and one other row with $n-1$ choices, and we can repeat this for the columns as well. So we have that there are $2n \binom{k}{2}(n-1)$ ways to have that there are 2 ones in 2 rows or two columns. To count the number in the diagonals, we choose an arbitrary $1$, so we have $nk$ choices, and then we choose another $1$ that is not in its row or column. This means that there are $(nk - 2k + 1)$ ones that can be chosen. However, we count each diagonal twice, meaning that we have $N_{\geq}(S_2) = nk(nk - 2k + 1)/2$.
\paragraph{$S_3$}
We choose an arbitrary entry with $1$ and another entry with $1$ on the same row and another entry with $1$ on the same column. Then we have $nk$ choices for which $1$, and $(k-1)(k-1)$ choices for $1$ in the same column. Therefore, we have that 
\begin{equation}
	m_0 - m_1 = \binom{n}{2}\binom{n}{2} - kn(n-1)^2 + \left( 2n \binom{k}{2}(n-1) + \frac{nk(nk - 2k + 1)}{2} \right) - nk(k-1)^2
\end{equation}

If $k \leq 1$, then we will simply replace $k$ with $n - k$ and change $m_0 - m_1$ to $m_1 - m_0$. If $n = 2$, then if $k = 0$, $m_0 = 1$, $m_1 = 0$, if $k = 1$, $m_0 = m_1 = 0$, and if $k = 2$, then $m_1 = 1$, $m_0 = 0$.
\subsection{Proof of correctness}
Suppose a submatrix has all entries 0. It is counted once in $N_{\geq}(S_0)$ and 0 everywhere else, so it counted once in $N_{=}(S_0)$. 

Suppose a submatrix has one entry equalling $1$ and zeroes everywhere else. It is counted once in $N_{\geq}(S_0)$ and once in $N_{\geq}(S_1)$, so it contributes $1 - 1 = 0$ times to the total of $N_{=}(S_0)$. 

Suppose a submatrix has two entries equalling $1$ and zeroes everywhere else. It is counted once in $N_{\geq}(S_0)$, twice in $N_{\geq}(S_1)$, and once in $N_{\geq}(S_2)$, so it contributes $1 - 2 + 1 = 0$ times to the total of $N_{=}(S_0)$.

Suppose a submatrix has three entries equalling $1$ and zeroes everywhere else. It is counted once in $N_{\geq}(S_0)$, three times in $N_{\geq}(S_1)$, three times in $N_{\geq}(S_2)$, and once in $N_{\geq}(S_3)$. So it is counted $1 - 3 + 3 - 1 = 0$ times overall.

Suppose a submatrix has four entries equalling $1$. It is counted once in $N_{\geq}(S_0)$, four times in $N_{\geq}(S_1)$, six times in $N_{\geq}(S_2)$, four times in $N_{\geq}(S_3)$, and once in $N_{\geq}(S_4)$. So it is counted $1 - 4 + 6 - 4 + 1 = 0$ times overall.
\end{document}
