\documentclass[]{article}
\usepackage[margin=1in]{geometry}

\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{url}

% Environments

\newtheorem{theorem}{Theorem}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{conjecture}[theorem]{Conjecture}

\theoremstyle{definition}
\newtheorem{example}[theorem]{Example}

\numberwithin{theorem}{section}
\numberwithin{equation}{section}

\newcommand{\ops}{\overset{\text{ops}}{\leftrightarrow}}
\newcommand{\egf}{\overset{\text{egf}}{\leftrightarrow}}

%opening
\title{Exam}
\author{Eric Luu}

\begin{document}

\maketitle
\section{Question 1}



\section{Question 2}

\section{Question 3}
\subsection{a}
We can use Cauchy-Frobenius with the group $\mathbb{Z}_n$ acting on the set of circular sequences.

\section{Question 4}

\section{Question 5}
Calculate the total number of diagrams and use a many to one relation.

\section{Question 6}

\subsection{a}
We have that the total number of games is $\binom{n}{3}$. We have that the number of schedules is $\binom{n}{3}^n$, where we allow conflics. Therefore, the proportion of schedules where players 1 and 2 play together in the first game is the same as the proportion of games where $1$ and $2$ play together out of all games. 

We have that the games where $1$ and $2$ play together are of the form $\{ 1, 2, k\}$ where $k \in [3, ..., n]$. There are $(n-2)$ of these games.
Therefore, the proportion is:
\begin{equation}
	\frac{(n-2)}{\binom{n}{3}} = \frac{(n-2)}{\frac{n(n-1)(n-2)}{6}} = \frac{6}{n(n-1)}.
\end{equation}

\subsection{b}
The number of games where player 1 and player 2 never play a game together is:
\begin{equation}
	\binom{n}{3} - (n-2)
\end{equation}
using the same logic above. Therefore, the number of schedules where player 1 and 2 never play a game together is:
\begin{equation}
	\left(\binom{n}{3} - (n-2)\right)^n.
\end{equation}
Then the proportion of games where $1$ and $2$ never play together is:
\begin{equation}
	\frac{\left(\binom{n}{3} - (n-2)\right)^n}{\binom{n}{3}^n} = \left(1 - \frac{(n-2)}{\binom{n}{3}}\right)^n = \left(1 - \frac{6}{n(n-1)}\right)^n.
\end{equation}
Now we have that
\begin{equation}
	\left(1 - \frac{6}{n(n-1)}\right)^n = \exp\left( n \log \left(1 - \frac{6}{n(n-1)}\right) \right) = \exp \left(n O(1/n^2)\right) = \exp( O(1/n)) = e^{o(1)} = (1 + o(1))
\end{equation}
therefore, we have that the number of schedules where 1 and 2 never play together is asymptotic to the number of schedules. 

\subsection{c}
We have that the number of games where no player in $[k] := \lbrace 1, 2, ..., k \rbrace$ plays together is:
\begin{equation}
	\underbrace{\binom{n - k}{2} k}_{\text{number of ways to choose two players not in $[k]$ and one from k}} + \underbrace{\binom{n-k}{3}}_{\text{number of ways to choose no players from $[k]$ }}
\end{equation}
Therefore, the proportion of games where no player in $[k]$ plays together is:
\begin{equation}
	\left(\binom{n - k}{2} k + \binom{n-k}{3}\right)^n \binom{n}{3}^{-n} = \left(\frac{\binom{n-k}{2} k}{\binom{n-k}{3}} + 1\right)^n \left(\frac{\binom{n-k}{3}}{\binom{n}{3}}\right)^n
\end{equation}

We have that:
\begin{align*}
	&= \left(\frac{\binom{n-k}{3}}{\binom{n}{3}}\right)^n\\
	&= \left( \frac{\frac{(n-k)(n-k - 1)(n - k - 2)}{6}}{\frac{n(n-1)(n-2)}{6}}  \right)^n\\
	&= \left(\frac{n-k}{n} \frac{n-k - 1}{n - 1} \frac{n - k - 2}{n - 2}\right)^n\\
	&= \left(1 - k/n\right)^n \left(1 - k/(n - 1)\right)^n \left(1 - k/(n-2)\right)^n
\end{align*}
Taking the log (will take exponential later), we have that this is equal to:
\begin{equation}
	n \left( \log(1 - k/n) +  \log(1 - k/(n-1)) + \log(1 - k/(n-2)) \right)
\end{equation}
and this is asymptotic to 
$n \left(3 \log(1 - k/n)\right)$ as we have that for large $n$, $1/n$ is asymptotic to $1/(n + o(1))$.

Now we have that:
\begin{align*}
	&\left(\frac{\binom{n-k}{2} k}{\binom{n-k}{3}} + 1\right)^n\\
	&= \left(\frac{(n-k)(n - k - 1)k}{2} \frac{6}{(n - k)(n - k - 1)(n - k - 2)} + 1\right)^n\\
	&= \left(\frac{3k}{n - k - 2} + 1\right)^n
\end{align*}
Taking the logs again, we have that this is
\begin{equation}
	n \log(1 + \frac{3k}{n - k - 2})
\end{equation}
Therefore, the log of the proportion is:
\begin{equation}
	n \left( 3 \log(1 - k/n) + \log\left(1 + \frac{3k}{n - k - 2}\right)\right)
\end{equation}

\subsubsection{i}
Now suppose $k \sim n^{1/4}$.
Take the log expansion of
$\log(1 - k/n) = -k/n + O(k^2/n^2)$ and $\log\left(1 + \frac{3k}{n - k - 2}\right) = \frac{3k}{n - k - 2} + O(k^2/(n- k)^2)$. 

Then we have that:
\begin{align*}
	n \left( 3 \log(1 - k/n) + \log\left(1 + \frac{3k}{n - k - 2}\right)\right) &= n \left(- 3k/n + 3k/(n - k - 2) + O(k^2/(n - k)^2)\right) \\
	&= -3k + 3kn/(n - k - 2) + O(k^2/(n - k)).
\end{align*}

We have that $3kn/(n - k - 2) = 3k/(1 - k/n - 2/n) = 3k(1 + O(k/n)) = 3k + O(k^2/n) =  3k + o(1)$. 
Now taking the exponential and the fact that $O(k^2/(n - k)) = O(1/\sqrt{n} = o(1))$, we have the proportion is:

\begin{equation}
	\frac{e^{3k}}{e^{3k}} = 1. 
\end{equation}

\subsubsection{ii}
Suppose $k \sim \sqrt{n}$. 
Take the log expansion 
$\log(1 - k/n)  = -k/n - \frac{k^2}{2n^2} + O(k^3/n^3)$, and $\log\left(1 + \frac{3k}{n - k - 2}\right) = \frac{3k}{n - k - 2} - \frac{9k^2}{2(n - k - 2)^2} + O(k^3/(n - k)^3)$. 

Then:
\begin{align*}
	n \left( 3 \log(1 - k/n) + \log\left(1 + \frac{3k}{n - k - 2}\right)\right) &=
	n \left(-3k/n - 3k^2/2n^2 + \frac{3k}{n - k - 2} - \frac{9k^2}{2(n - k - 2)^2} + O(k^3/(n - k)^3)\right)\\
	&= -3k - 3k^2/2n + \frac{3kn}{n - k - 2} - \frac{9k^2 n}{(n - k - 2)^2} + O(k^3/(n - k)^2)
\end{align*}
Now we have that $\frac{3kn}{n - k - 2}  \sim 3k$ from the argument above, and $\frac{9k^2 n}{(n - k - 2)^2} = \frac{1}{n} \frac{9 k^2}{(1 - k/n - 2/n)^2} = \frac{9k^2}{n}(1 + O(k/n)) = \frac{9k^2}{n} + o(1)$. Therefore, taking the exponent of both sides, we have that this is:
\begin{equation}
	\frac{e^3k }{e^{3k + 3k^2/2n + 9k^2/n}} = e^{-21/2 k^2/n}
\end{equation}
and as $k \sim \sqrt{n}$, so $k^2/n \sim 1$, then this becomes $e^{-21/2}$. 

\section{Question 7}
Find an asymptotic formula for:
\begin{equation}
	\sum_{k = 0}^n \binom{3n - k}{k} 2^k.
\end{equation}
Let $a_k := \binom{3n - k}{k} 2^k = \frac{(3n - k)!}{k! (3n - 2k)!} 2^k$.
We have that:
\begin{align*}
	a_{k + 1} &= \frac{(3n - k - 1)!}{(k + 1)! (3n - 2k - 2)!} 2^{k + 1}\\
	\frac{a_{k + 1}}{a_k} = \frac{(3n - 2k)(3n - 2k - 1) 2}{(k + 1)(3n - k)}
\end{align*}
Setting $\frac{a_{k + 1}}{a_k}$ to find the inflection point, we have that:
\begin{equation}
	(3n - 2k)(3n - 2k - 1) 2 = (k + 1)(3n - k)
\end{equation}

Plugging this equation into WolframAlpha and solving for $k$, we have that:
\begin{equation}
	k = \frac{1}{18}\left(- \sqrt{81 n^2 + 54 n + 25} + 27 n + 5\right)
\end{equation}
and expanding out $\sqrt{81 n^2 + 54 n + 25} = 9 n(1 + O(1))$, we have that:
$k \sim n$. 

Around $n$, we have that $\binom{3n - k}{k} 2^k$ approximates a symmetric function. So we need to evaluate the summation
\begin{equation}
	\frac{1}{2}\sum_{y = n - M}^{n + M} \binom{3n - y}{y} 2^y
\end{equation}
and show that the tail $\sum_{k = 0}^{n - M} \binom{3n - k}{k} 2^k$ is negligible.

\subsection{Evaluating main sum}
Now let $z = y - n$. We have that the summation becomes:
\begin{equation}
	\sum_{z = -M}^M \binom{2n - z}{n + z} 2^n 2^z = \sum_{z = -M}^M\frac{(2n - z)!}{(n + z)! (n - 2z)!} 2^{n + z}. 
\end{equation}

Now we have that by Stirling:
\begin{align*}
	(2n - z)! &\sim (2n - z)^{2n-z}/e^{2n - z} \sqrt{2 \pi (2n-z)}\\
	(n + z)! &\sim (n + z)^{n + z}/e^{n + z} \sqrt{2 \pi (n + z)}\\
	(n - 2z)! &\sim (n - 2z)^{n - 2z}/e^{n - 2z} \sqrt{2 \pi (n -2z)}
\end{align*}
so we have that the total sum becomes:
\begin{align*}
	&\sum_{z = -M}^M \frac{(2n - z)^{2n - z}}{(n + z)^{n + z} (n - 2z)^{n - 2z}} \frac{e^{n + z} e^{n - 2z}}{e^{2n - z}} \frac{\sqrt{2\pi (2n - z)}}{\sqrt{2\pi (n + z)} \sqrt{2\pi (n - 2z)}} 2^{n} 2^z \\
	&= \frac{1}{\sqrt{2\pi}}\sum_{z = -M}^M \frac{(2n - z)^{2n - z}}{(n + z)^{n + z} (n - 2z)^{n - 2z}} \sqrt{\frac{2n - z}{(n + z)(n - 2z)}} 2^{n} 2^z
\end{align*}

Now we have that when $M = o(n^{2/3})$,
\begin{align*}
	(2n - z)^{2n-z}  &=  (2n)^{2n-z} \exp(-z + z^2/4n + O(z^3/n^2)) = (2n)^{2n-z} \exp(-z + z^2/4n)\\
	(n + z)^{n + z} &= n^{(n + z)} \exp(z + 1/2 z^2/n + O(z^3/n^2)) = n^{(n + z)} \exp(z + 1/2 z^2/n) \\
	(n - 2z)^{n - 2z} &= n^{n -2z} \exp\left( (n - 2z) \log(1 - 2z/n)\right)\\
	&= n^{n -2z} \exp\left( (n - 2z) (-2z/n - 2z^2/n^2 + O(z^3/n^3))\right)\\
	&= n^{n -2z} \exp\left( -2z + 2z^2/n + O(z^3/n^2)\right) = n^{n -2z} \exp( -2z + 2z^2/n)
\end{align*}
Therefore, we have that the sum becomes:
\begin{align*}
	&\frac{1}{\sqrt{2\pi}}\sum_{z = -M}^M \frac{(2n)^{2n-z} \exp(-z + z^2/4n) }{n^{(n + z)} \exp(z + 1/2 z^2/n) n^{n -2z} \exp( -2z + 2z^2/n) } \sqrt{\frac{2n - z}{(n + z)(n - 2z)}} 2^{n} 2^z\\
	&= \frac{1}{\sqrt{2\pi}}\sum_{z = -M}^M 2^{2n-z} \exp(- 9z^2/4n) \sqrt{\frac{2n - z}{(n + z)(n - 2z)}} 2^{n} 2^z\\
	&= \frac{2^{3n}}{\sqrt{2\pi}} \sum_{z = -M}^M  \exp(- 9z^2/4n) \sqrt{\frac{2n - z}{(n + z)(n - 2z)}}
\end{align*}
We have that as $z = o(n^2/3)$, then
\begin{align*}
	\sqrt{\frac{2n - z}{(n + z)(n - 2z)}} &= \sqrt{1/(n + z) + 1/(n - 2z)}\\
	 &= \frac{1}{\sqrt{n}} \sqrt{1/(1 + z/n) + 1/(1 - 2z/n)}\\
	 &= \frac{1}{\sqrt{n}} \sqrt{1 -z/n + 1 + 2z/n + O(z^2/n^2)}\\
	 &= \frac{1}{\sqrt{n}} \sqrt{2 + o(1)}\\
	 &= \frac{\sqrt{2}}{\sqrt{n}} 
\end{align*}
Therefore, we have that the summation is:
\begin{equation}
	\frac{2^{3n}}{\sqrt{\pi n}} \sum_{z = -M}^M  \exp(- 9z^2/4n) 
\end{equation}
and using the fact that $ M = n^{2/3}$, we can use the fact that $\alpha(n) = 9/(4n)$ and we have that $M \alpha \rightarrow 0$, $M \sqrt{\alpha} \rightarrow \infty$ to yield:
\begin{equation}
	\frac{2^{3n}}{\sqrt{\pi n}} \sum_{z = -M}^M  \exp(- 9z^2/4n)  = \frac{2^{3n}}{\sqrt{\pi n}} \sqrt{\frac{4 \pi n}{9}} = \frac{2}{3} 2^{3n}
\end{equation}
Therefore, we have that the summation:
\begin{equation}
	\sum_{y = n - M}^n \binom{3n - y}{y} 2^y = \frac{1}{2} \sum_{y = n - M}^{n + M}\binom{3n - y}{y} 2^y = \frac{2^{3n}}{3}
\end{equation}
\subsection{Tail is negligible}
To show that the tail is negligible, we want to show
\begin{equation}
	\sum_{k = 0}^{n^{2/3}}\binom{3n - k}{k} 2^k = o(S)
\end{equation}
where $S$ is the sum above. 
We have that at $n^{2/3}$, the term above is at most $\left(\frac{e(3n - n^{2/3})}{n^{2/3}}\right)^{n^{2/3}} 2^{n^{2/3}}$, as we have that $\binom{n}{k} \leq \left(\frac{n \cdot e}{k}\right)^k$ (from Wikipedia). Now we have that this is at most $(3e n^{1/3})^{n^{2/3}} 2^{n^{2/3}} = (6e)^{n^{2/3}} n^{n^{2/3}/3}$, so the full summation is bounded above by:
\begin{equation}
	(6e)^{n^{2/3}} n^{n^{2/3}/3} n^{2/3}.
\end{equation} 
But notice that $(2^n)^3$ bounds the product of each of these terms as when taking logs of both equations, we have a $3n$ term out but the largest term out is a $\log n n^2/3$. Therefore, we have that the term above is of $o(S)$. Therefore, the tail is negligible. 
\section{Question 8}
\subsection{a}
We shall use cards, decks and hands. Each card will be a standard deck with a number in $[n]$ in the centre. Now we have that the number of decks is $n$ for each $n \geq 1$, therefore the deck enumerator is $D(x) = \sum_{n \geq 1} n \frac{x^n}{n!} = \sum_{n \geq 1} \frac{x^n}{(n - 1)!} = x e^x$. 
Therefore, the egf for the number of labelled galaxies is $f(x) = e^{D(x)} = e^{x e^x}$. 

\subsection{b}
Now we have that for all $r > 0$, $r \in \mathbb{R}$, we have that:
\begin{equation}
	[z^n] f(z) \leq r^{-n} f(r).
\end{equation}
To find the minimum, take $D \log$ of $r^{-n} f(r)$. We have that this is $D(-n \log r + r e^r) = 0$, or $-n/r + e^r + r e^r = 0$. Therefore, we have that:
\begin{equation}
	-n + r e^r + r^2 e^r = 0
\end{equation}
or that:
\begin{equation}
	r (r + 1) e^r = n
\end{equation}.
Therefore, the saddlepoint upper bound of $[x^n] f(x)$ is at $r(n)$, so the bound is $r(n)^{-n} e^{r(n) e^{r(n)}}$ where $r(n)$ is defined above. 

\section{Question 9}
\end{document}
