\documentclass[]{article}
\usepackage[margin=1in]{geometry}
\usepackage{amsmath}
\usepackage{amssymb}

\usepackage{hyperref}
\usepackage{cleveref}

\newcommand{\ops}{\overset{\text{ops}}{\leftrightarrow}}
\newcommand{\egf}{\overset{\text{egf}}{\leftrightarrow}}
%opening
\title{Assignment 4}
\author{Eric Luu}

\begin{document}

\maketitle
\section{1}
\subsection{Finding maximum of asymptotic}
Firstly, let $a_k = \frac{(n + k)!}{n!(k!)^2}$. Then let us calculate 
\begin{equation}
	R_k = \frac{a_{k + 1}}{a_k} = \frac{n!(k!)^2}{(n + k)!}\frac{(n + k + 1)^2}{n! (k + 1)!} = \frac{n + k + 1}{(k + 1)^2}. 
\end{equation}
Then we have that $R_k = 1$ when $n + k + 1 = (k + 1)^2$. Solving for $k$, we have that $(k + 1)^2 - (k + 1) - n = 0$, therefore $k + 1 = \frac{1 + \sqrt{1 + 4n}}{2}$ by solving the quadratic. Therefore, $k \sim \sqrt{n}$, and around this the function falls off. 
\subsection{Calculating near maximum}
Let us calculate this equation around $\sqrt{n}$. 

We want to calculate:
\begin{equation}
	\sum_{k = \lfloor \sqrt{n} - M \rfloor }^{ \lceil \sqrt{n} + M \rceil}  \frac{(n + k)!}{n!(k!)^2}.
\end{equation}
Now let $y = k - \sqrt{n}$. We will re-index the equation to match what we have.

We use Stirling's approximation.
\begin{align*}
	(n + k)! &= \left(\frac{n + k}{e}\right)^{n + k}\sqrt{2\pi (n + k)}\\
	n! &= \left(\frac{n}{e}\right)^n \sqrt{2 \pi n}\\
	k! &= \left(\frac{k}{e}\right)^k \sqrt{2 \pi k}\\
\end{align*}
Substituting this into the equation, we have that:
\begin{align*}
	\sum_{k = \lfloor \sqrt{n} - M \rfloor }^{ \lceil \sqrt{n} + M \rceil}  \frac{(n + k)!}{n!(k!)^2}
	&=
	\sum_{k = \lfloor \sqrt{n} - M \rfloor }^{ \lceil \sqrt{n} + M \rceil} \frac{\left(\frac{n + k}{e}\right)^{n + k}\sqrt{2\pi (n + k)}}{\left(\frac{n}{e}\right)^n \sqrt{2 \pi n} \left(\frac{k}{e}\right)^{2k} (2 \pi k)}\\
	&=
	\sum_{k = \lfloor \sqrt{n} - M \rfloor }^{ \lceil \sqrt{n} + M \rceil} \frac{1}{e^k 2\pi} \frac{\left(n + k\right)^{n + k}\sqrt{(n + k)}}{\left(n\right)^n \sqrt{n} \left(k\right)^{2k}k }\\
\end{align*}
We have that when $y = o(\sqrt{n})$, then:
\begin{align*}
	(n + \sqrt{n} + y)^{n + \sqrt{n} + y} &= \exp\left((n + \sqrt{n} + y) \log(n + \sqrt{n} + y)\right)\\
	&=
	\exp\left((n + \sqrt{n} + y) \log(n) +  (n + \sqrt{n} + y) \log (1 + \frac{1}{\sqrt{n}} + \frac{y}{n})\right)\\
	&=
	n^{n + \sqrt{n} + y} \exp\left((n + \sqrt{n} + y) \log(1 + \frac{1}{\sqrt{n}} + \frac{y}{n})
	\right)
\end{align*}
Now we have that $\log(1 + \frac{1}{\sqrt{n}} + \frac{y}{n}) = \frac{1}{\sqrt{n}} + \frac{y}{n} + O(\frac{y^2 + 2yn + n}{n^2})$. But we have that $y = o(\sqrt{n}$, so $O(\frac{y^2 + 2yn + n}{n^2}) = o(1)$. Then we have that 

Now suppose 
\section{2}
We wish to show that $e^k k^{n - k} \sim e^w w^{n - w}$. This is equivalent to showing that:
\begin{equation}
	\frac{e^k k^{n - k}}{e^w w^{n - w}} \sim 1.
\end{equation}
We can rewrite this as:
\begin{equation}
	e^{k - w} \frac{k^{n - k}}{w^{n - w}}.
\end{equation}
Now we have that $k = w + y$ for $y = O(1)$. We input this in and rearrange.
\begin{equation}
	e^{y} \frac{w^w}{k^k} \frac{k^n}{w^n} 
\end{equation}
We use the fact that when $y = O(1)$, we have that $k^k = (w + y)^{w + y} = \exp((w + y) \log(w + y))$. But $\log(w + y) = \log(w) + \log(1 + y/w) = \log(w) + 1 + y/w + O(y^2/w^2)$. Then we have that $(w + y)^{w + y}  = \exp((w + y) \log(w) + (w + y) (1 + y/w + O(y^2/w^2)) = w^{w + y} \exp(w + 2y + O(\frac{1}{w}))$. But we have that $w$ is increasing and unbounded, so $O(\frac{1}{w}) = o(1)$. So:
\begin{equation}
	k^k = (w + y)^{w + y}  = w^{w + y} \exp(w + 2y).
\end{equation}
Therefore, we have that:
\begin{equation}
	e^{y} \frac{w^w}{w^{w + y}\exp(w + 2y)} \frac{k^n}{w^n} = \frac{1}{w^y \exp(w + y)} \frac{k^n}{w^n} = \frac{k^n}{w^{n + y} \exp(w + y)}.
\end{equation}
What remains to show is that 

\subsection{$w$ as a bound of $n$}
We have that $w \log (w + 1) = n$. 
From bounds, we have that when $w = 0$, the left hand side is $0$. When $w = n$, we have that the left hand side is $n \log(n + 1) > n$. Therefore as the function is increasing, $0 < w < n$. 

Rearrange so that we have that $w = \frac{n}{\log(w + 1)}$. Now suppose $w = \alpha n$ for some $\alpha$ in $O(1)$. Then we have that:
\begin{align*}
	w &= \frac{n}{\log(\alpha n + 1)}\\
	&= \frac{n}{\log(\alpha n) (1 + \frac{1}{\alpha n})}\\
	&=\frac{n}{\log(\alpha) + \log(n) - \log(1 + \frac{1}{\alpha n})}\\
	&= \frac{n/ \log n}{\log(\alpha)/\log n + 1 - \log(1 + 1/\alpha n)/\log n}\\
\end{align*}
We then can use the fact that $1/(1 + o(1)) = (1 + o(1))$ to show that:
\begin{align*}
	w &= n / \log n (1 + O(\log n))
\end{align*}
so $w \sim n / \log n$. 

\section{3}
\subsection{a}
We have the equation:
\begin{equation}
	k = n + \sqrt{n + k} \log k.
\end{equation}
Now notice that both sides of the equation are strictly increasing with fixed $n$ and $k > 1$. Now if $k = n$, we have that the LHS is $n$ and the RHS is $n + \sqrt{2n} \log n$, which means $RHS > LHS$. Now when $k = 2n$, we have the LHS is $2n$ and the RHS is $n + \sqrt{3n} \log n$ which for large $n$ is less than $2n$. Therefore, $LHS > RHS$. By continuity and the fact that both sides are nondecreasing, we have that $k$ has a solution and it is between $n$ and $2n$. 
\subsection{b}
Let $k = \alpha n$ where $\alpha = O(1)$ and $1 < \alpha < 2$. 
Then we have that 
$k = n + \sqrt{n + \alpha n} \log (\alpha n) = n + \sqrt{n} \sqrt{\alpha + 1} (\log(\alpha) + \log n)$. Then we distribute and use the fact that $\alpha = O(1)$ to get that
\begin{align*}
	k &= n + \sqrt{n} O(1) + \log n \sqrt{n} O(1)\\
	 &= n + O(\sqrt{n}) + O(\log n \sqrt{n})\\
	 &= n + O(\log n \sqrt n).
\end{align*}
However, we can write the right hand side as $k = n(1 + O(\frac{\log n}{\sqrt{n}}))$ which is $k = n(1 + o(1))$. So $k \sim n$. 
\subsection{c}
Let $z = k - n$. From part $a$, we have that $0 < k < n$ and $z =  O(\log n \sqrt n)$. Then we rewrite the above equation in terms of $z$ to yield:
\begin{equation}
	z = \sqrt{z + 2n} \log (z + n).
\end{equation}
Now we plug in the approximation that $z = O(\log n \sqrt{n})$. We have that:

\begin{align*}
	z &= \sqrt{(O(\log n \sqrt{n}) + 2n)}\log(n + O(\log n \sqrt n))\\
	&= \sqrt{2n} \left(\sqrt{1 + O(\frac{\log n}{\sqrt{n}})}\right) \left(\log( n(1 + O(\frac{\log n}{\sqrt{n}} )) \right)\\
	&= \sqrt{2n}\left(\sqrt{1 + O(\frac{\log n}{\sqrt{n}})}\right) \log(n) + \sqrt{2n}\left(\sqrt{1 + O(\frac{\log n}{\sqrt{n}})}\right) \log((1 + O(\frac{\log n}{\sqrt{n}}))
	\end{align*}
Now we have that from doing a Taylor expansion that $\sqrt{1 + x} = 1 + O(x)$ when $x = o(1)$. We also have that $\log(1 + x) = O(x)$ when $x = o(1)$. Plugging this both into the equation, we have that:
\begin{align*}
	z &= \sqrt{2n}(1 + O(\frac{\log n}{\sqrt{n}})) \log(n) + \sqrt{2n}(1 + O(\frac{\log n}{\sqrt{n}}))O(\frac{\log n}{\sqrt{n}})\\
	&= \sqrt{2n} \log n + O(\log n) + O(\log n) + O(\frac{\log^2 n}{\sqrt{n}})\\
	&= \sqrt{2n} \log n + O(\log n)
\end{align*}
as we have that $\log^2(n) = o(\sqrt{n})$. Finally, we have that:
\begin{equation}
	z = \sqrt{2n} \log n ( 1 + O(\frac{1}{\sqrt{n}})) = \sqrt{2n} \log n (1 + o(1)).
\end{equation}
So $z \sim \sqrt{2n} \log n$.

\subsection{b}
Let
\begin{equation}
	k = \frac{n^2}{n + k \log k}
\end{equation}
Let $k = 1$. Then we have the LHS is $1$ and the RHS is $\frac{n^2}{n + 0} = n$. Let $k = n$. Then we have the LHS is $n$ and the RHS is $\frac{n^2}{n + n \log n} = \frac{n}{1 + \log n}$.

Now rearrange the equation. We have that $n^2 = nk + k^2 \log k$. But this implies that $n^2 - nk - k^2 \log k = 0$. Therefore, we have that:
\begin{equation}
	n = \frac{k \pm \sqrt{k^2 + 4 k^2 \log k}}{2}.
\end{equation}
The equation that makes the most sense is if $\pm = +$ otherwise $n$ is negative. 
Simplifying, we have that $n = \frac{k + k \sqrt{(1 + 4\log k)}}{2} = \frac{k (1 + \sqrt{1 + 4\log k})}{2}$. Now we rearrange to get that:
\begin{equation}
	k = \frac{2n}{\sqrt{1 + 4\log k}}
\end{equation}
Now suppose $k = \alpha n$ for $\alpha = O(1)$, $0 < \alpha < 1$. 
Then we have that:
\begin{align*}
	k = \frac{2n}{\sqrt{1 + 4(\log \alpha) + 4\log n}}\\
	k = \frac{2n}{\sqrt{4\log n} \sqrt{1 + (\log \alpha/4\log n) + 1/4\log n}}
\end{align*}
But we have that $\frac{1}{\sqrt{1 + x}} = 1 + O(x)$ when $x = o(1)$. Therefore, we have that
\begin{align*}
	k &= \frac{n}{\sqrt{\log n}} \left( 1 + O(1/ \log n) \right)\\
	k &=\frac{n}{\sqrt{\log n}} (1 + o(1))\\
	k &\sim \frac{n}{\sqrt{\log n}}.
\end{align*}

\section{4}
\subsection{a}
We have that $b_0 = 0$, $b_1 = a_1$. We have that $a_0 = 0$ as well. For the recurrence, we have that $b_n = \sum_{i = 1}^{n} a_i b_{n - i} = \sum_{i = 0}^{n} a_i b_i + a_n$. We have that $[x^n]a(x) b(x) = \sum_{i = 0}^{n} a_i b_{n - i}$.  Therefore, we have that $b(x) =  a(x)(b(x) + 1) = a(x) b(x) + a(x)$. Shuffling around, we have that:
\begin{equation}
	b(x) = \frac{a(x)}{1 - a(x)}.
\end{equation}
\subsection{b}
Let $S$ be the radius of convergence of $a$. We have that $A > 1/S$ as $|a_n|^{1/n} \leq A$ i.o. Therefore, we have that $1/A < S$. As $a(x)$ is strictly increasing on $0$ to $S$, we have that $a(x) < a(1/A)$ when $x < 1/A$ on the boundary. We have that the only singularity of $b$ occurs when $a(x) = 1$. Note that we have that $a(x e^{i\theta}) \leq a(x)$ for all $x> 0$, so we have that $b$ converges on a radius smaller than $1/A$, as $a(1/A - \varepsilon) < 1$ by the argument above. Therefore, we have that $b(x)$ has a radius of convergence which includes $|z| = 1/A$. Therefore, we have that $b_n < \left(A + \varepsilon \right)^n$ eventually. 

\subsection{c}
Firstly, we have that we have that $a(x e^{i\theta}) \leq a(x)$ for all $x > 0$. We also have that $a(x)$ is increasing between $0$ and $1/A$. Therefore, if $a(C) = 1$ and $C$ is the minimum positive real satisfying this equation, then for all $z$ where $|z| < C$, we have that $b$ converges. Therefore, radius of convergence of $b$ is $C$. Therefore, $b_n > \left(1/C - \varepsilon \right)^n$ i.o. 

\section{5}

\subsection{a}
We will prove this using deck and hands
We have that the deck that we are dealing with are $n$-cycles which are even. In other words, we want that every connected component has an even number of vertices. We know that the deck enumerator for connected $2$-regular graphs is:
\begin{equation}
	D(x) = \frac{1}{2}\left(\log\left(\frac{1}{1 - x}\right) - x - \frac{x^2}{2}\right)
\end{equation}
Therefore, the deck enumerator for connected $2$-regular graphs of even cycle length is:
\begin{align}
	E(x) = \frac{1}{2} \left(D(x) + D(-x)\right) &= \frac{1}{4} \left[ \left(\log\left(\frac{1}{1 - x}\right) - x - \frac{x^2}{2}\right) + \left(\log\left(\frac{1}{1 + x}\right) + x - \frac{x^2}{2}\right) \right]\\
	&=\frac{1}{4} \left(\log\left(\frac{1}{(1 - x)(1 + x)}\right) - x^2\right) \\
	&=\frac{1}{4} \left(\log\left(\frac{1}{1 - x^2}\right)- x^2\right) 
\end{align}
Then the egf for the number of $2$-regular bipartite graphs is:
\begin{equation}
	e^{E(x)} = \exp\left(\log\left(\frac{1}{(1 - x^2)^{1/4}}\right)- \frac{x^2}{4}\right)  = \frac{e^{-x^2/4}}{(1 - x^2)^{1/4}}
\end{equation}

\subsection{b}
We have that $x$ is analytic in $\left\{ z: |z| < 1 + \varepsilon \right\} \setminus \left\{ -1, 1 \right\}$. Fix a $\delta > 0$. Let $C_1$ be the curve $|z| = 1 + \delta$ moving counterclockwise  and let $C_2$ be the curve $|z - 1| = \delta$ going clockwise. Let $C_3$ be the curve $|z + 1| = \delta$ moving clockwise. We will use a variant of Darboux's theorem to find the asymptotics.
\section{6}
\subsection{a}
We shall think about this in the form of decks. Let a card be a connected digraph where no two edges share a vertex. We have that $d_1 = 1$ as there is only one standard card of size 1, which is the singleton vertex with label $1$. We have $d_2 = 2$ as there are two cards, the vertex $1$ pointing to the vertex $2$, and the vertex $2$ pointing to the vertex $1$. Then the deck enumerator is $x + \frac{1}{2} (2) x^2 = x + x^2$, so the egf for $\left\{ c_n\right\}_{n \geq 0}$ is $f(x) := e^{x + x^2}$.

\subsection{b}
We have that $f$ is entire on $\mathbb{C}$. Therefore, the radius of convergence is infinite. Thus, we can evaluate $f$ everywhere. We have that from the saddlepoint bound for egfs that
\begin{equation}
	[x^n] f(n) \leq x_0^{-n} f(x_0)
\end{equation}
so substituting this in, we have that:
\begin{equation}
	c_n \leq r^{-n} e^{r + r^2}.
\end{equation}
To find when $r$ is minimised, we take the derivative. So we get that:
\begin{align*}
	 r^{-n} e^{r + r^2} &= e^{-n \log r + r + r^2}\\
	 0 &= \dfrac{d}{dr}(e^{-n \log r + r + r^2}) \\
	 0 &= \left(2r + 1 - \frac{n}{r}\right) e^{-n \log r + r + r^2}\\
	 0 &= 2r + 1 - \frac{n}{r}\\
	 0 &= 2r^2 + r - n\\
\end{align*}
From the quadratic equation, we have that $r = \frac{-1 \pm \sqrt{1 + 8n}}{4}$, so taking the smaller of the two in absolute magnitude, we have that:
\begin{equation}
	r = \frac{\sqrt{1 + 8n} - 1}{4}
\end{equation}

\subsection{c}
We rewrite $r$ as:
\begin{equation}
	r = \frac{\sqrt{8n + 1}}{4} - \frac{1}{4}
\end{equation}
and then take a factor of $8n$ out of the square root. So we have that:
\begin{equation}
	r = \frac{\sqrt{8n}\sqrt{1+ 1/8n}}{4} - \frac{1}{4}
\end{equation}
Now we have that $\sqrt{1 + x} = 1 + x/2 + O(x^2)$ so we have that:
\begin{align*}
	r &= \frac{\sqrt{8n}\left(1 + \frac{1}{16n} + O(\frac{1/n^2}{den})\right)}{4} - \frac{1}{4}\\
	&= \sqrt{\frac{n}{2}} + \frac{1}{8 \sqrt{2 n}} - \frac{1}{4} + O(\frac{1}{n^{3/2}})
\end{align*}
which has additive error $o(\frac{1}{n})$. 

\subsection{d}

\subsection{e}
\end{document}